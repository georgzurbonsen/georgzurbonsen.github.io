<!DOCTYPE html>
<html lang="en-US">	

<head>
<meta charset="utf-8"/>
<title>B4P Reference</title>
<link rel="stylesheet" href="styles.css">
</head>


<div class="wrapper">

<div class="logo">
<a href="index.html">
<img src="Images/B4P_Logo.png" alt="B4P">
</a>
</div>

<div class="header">
<h3>table expand fast ...</h3>
<a accesskey="p" href="REF_Function_table_expand.html"><span>Prev</span></a> <a accesskey="n" href="REF_Function_table_expand_smart.html"><span>Next</span></a> 
</div>

<section>
	<div class="nav">
<div class="booktitle_field">Reference Manual</div>
<ul>
<li class="navi"><a href="GUI_Features_overview.html"><div class="navi"> &#8594; User Guide </div></a></li>
<li class="navi"><a href="REF_Features_Table_of_Contents.html"><div class="navi"> Table of Contents </div></a></li>
<li class="navi"><a href="REF_Features_starting.html"><div class="navi">+ 1 Starting B4P </div></a></li>
<li class="navi"><a href="REF_Features_introduction.html"><div class="navi">+ 2 Introduction </div></a></li>
<li class="navi"><a href="REF_Features_variable.html"><div class="navi">+ 3 Variables </div></a></li>
<li class="navi"><a href="REF_Features_tables.html"><div class="navi">+ 4 Tables </div></a></li>
<li class="navi"><a href="REF_Features_assignments.html"><div class="navi">+ 5 Assignments and Expressions </div></a></li>
<li class="navi"><a href="REF_Features_Transactions.html"><div class="navi">+ 6 Transactions </div></a></li>
<li class="navi"><a href="REF_Features_Functions_and_Procedures.html"><div class="navi">+ 7 Functions and Procedures </div></a></li>
<li class="navi"><a href="REF_Features_Function_Library.html"><div class="navi">8 Function Library </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="REF_Features_Control_Flow_Functions.html"><div class="navi">+ 8.1 Control Flow Functions </div></a></li>
<li class="navi"><a href="REF_Features_input_output_functions.html"><div class="navi">+ 8.2 Input / Output Functions </div></a></li>
<li class="navi"><a href="REF_Features_Type_Conversion_Functions.html"><div class="navi">+ 8.3 Type Conversion and Formatting Functions </div></a></li>
<li class="navi"><a href="REF_Features_Mathematics_and_Statistics.html"><div class="navi">+ 8.4 Mathematics and Statistics </div></a></li>
<li class="navi"><a href="REF_Features_string_functions.html"><div class="navi">+ 8.5 String Functions </div></a></li>
<li class="navi"><a href="REF_Features_date_and_time_functions.html"><div class="navi">+ 8.6 Date and Time Functions </div></a></li>
<li class="navi"><a href="REF_Features_parameter_set_functions.html"><div class="navi">+ 8.7 Parameter Set Functions </div></a></li>
<li class="navi"><a href="REF_Features_table_functions.html"><div class="navi">+ 8.8 Table Functions - Basics </div></a></li>
<li class="navi"><a href="REF_Features_table_functions_processing.html"><div class="navi">+ 8.9 Table Functions - Processing </div></a></li>
<li class="navi"><a href="REF_Features_advanced_table_functions.html"><div class="navi">8.10 Table Functions - Advanced </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="REF_Features_Checking_and_comparing_tables.html"><div class="navi">+ 8.10.1 Checking and Comparing Tables </div></a></li>
<li class="navi"><a href="REF_Features_Looking_up_Other_Tables.html"><div class="navi">8.10.2 Looking up Other Tables </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="REF_Function_table_lookup.html"><div class="navi">8.10.2.1 table lookup ... </div></a></li>
<li class="navi"><a href="REF_Function_table_lookup_once.html"><div class="navi">8.10.2.2 table lookup once ... </div></a></li>
<li class="navi"><a href="REF_Function_table_lookup_fast.html"><div class="navi">8.10.2.3 table lookup fast ... </div></a></li>
<li class="navi"><a href="REF_Function_table_lookup_smart.html"><div class="navi">8.10.2.4 table lookup smart ... </div></a></li>
<li class="navi"><a href="REF_Function_table_lookup_smart_once.html"><div class="navi">8.10.2.5 table lookup smart once ... </div></a></li>
<li class="navi"><a href="REF_Function_table_integrate.html"><div class="navi">8.10.2.6 table integrate ... </div></a></li>
<li class="navi"><a href="REF_Function_table_integrate_once.html"><div class="navi">8.10.2.7 table integrate once ... </div></a></li>
<li class="navi"><a href="REF_Function_table_integrate_fast.html"><div class="navi">8.10.2.8 table integrate fast ... </div></a></li>
<li class="navi"><a href="REF_Function_table_integrate_smart.html"><div class="navi">8.10.2.9 table integrate smart ... </div></a></li>
<li class="navi"><a href="REF_Function_table_integrate_smart_once.html"><div class="navi">8.10.2.10 table integrate smart once ... </div></a></li>
<li class="navi"><a href="REF_Function_table_expand.html"><div class="navi">8.10.2.11 table expand ... </div></a></li>
<li class="navi"><a href="REF_Function_table_expand_fast.html"><div class="navi navi-selected">8.10.2.12 table expand fast ... </div></a></li>
<li class="navi"><a href="REF_Function_table_expand_smart.html"><div class="navi">8.10.2.13 table expand smart ... </div></a></li>
<li class="navi"><a href="REF_Function_table_expand_fast_smart.html"><div class="navi">8.10.2.14 table expand fast smart ... </div></a></li>
<li class="navi"><a href="REF_Features_Table_integration_operation_identifiers.html"><div class="navi">8.10.2.15 Table Integration Operation Identifiers </div></a></li>
</ul></li>
<li class="navi"><a href="REF_Features_Pivoting_and_consolidating_tables.html"><div class="navi">+ 8.10.3 Pivoting and Conosolidating Tables </div></a></li>
<li class="navi"><a href="REF_Features_Combining_Multiple_Tables.html"><div class="navi">+ 8.10.4 Combining Multiple Tables </div></a></li>
<li class="navi"><a href="REF_Features_Exploring_and_Extracting_Tables.html"><div class="navi">+ 8.10.5 Exploring and Extracting Tables </div></a></li>
</ul></li>
<li class="navi"><a href="REF_Features_Formatting_and_Styling_Tables.html"><div class="navi">+ 8.11 Table Functions - Formatting and Styling </div></a></li>
<li class="navi"><a href="REF_Features_variables_functions.html"><div class="navi">+ 8.12 Variables Functions </div></a></li>
<li class="navi"><a href="REF_Features_directory_and_file_system_functions.html"><div class="navi">+ 8.13 Directory and File System Functions </div></a></li>
<li class="navi"><a href="REF_Features_system_functions.html"><div class="navi">+ 8.14 System Functions </div></a></li>
<li class="navi"><a href="REF_Features_help_and_support_functions.html"><div class="navi">+ 8.15 Help and Support Functions </div></a></li>
<li class="navi"><a href="REF_Features_Cross-functional_info.html"><div class="navi">+ 8.16 Cross-Functional Info </div></a></li>
</ul></li>
</ul></li>
</ul>
	</div>

	<div class="article">
<h4> Function Names</h4>
<div class="white_background_color" ><code>table expand fast, table expand fast ignore case</code></div>
<h4> Description</h4>
<p>
This function works similarly to <a class="bold_text" href="REF_Function_table_expand.html">table expand</a>(), with the only exception that the additional roes resulting from multiple lookups
are appended at the bottom of the table rather than inserting them below the original row.  For very large target tables, this approach
saves significant becuase no rows will be shifted repeatedly.  Consider sorting the table, e.g. using <a class="bold_text" href="REF_Function_table_sort_rows.html">table sort rows</a>() afterwards, if needed.

<br/><br/><img src="Images/Function_table_expand_fast.jpg" alt="Function 'table expand fast'"><br/><br/>

<u>Attention</u>: Do not confuse with the functions <a class="bold_text" href="REF_Function_table_lookup_fast.html">table lookup fast</a>() and <a class="bold_text" href="REF_Function_table_integrate_fast.html">table integrate fast</a>() where the 'fast' in the
function name refers to an optimized searching scheme suitable for pre-sorted tables.
</p>
<h4> Call as: <span class="black_text">procedure or function</span></h4>
<h4> Restrictions</h4>
<p>Indirect parameter passing is disabled</p>
<h4> Parameter count</h4>
<p>7 - 9 (For parameter description and return values: see <a class="bold_text" href="REF_Function_table_integrate.html">table integrate</a>() )</p>
<h4> Examples</h4>
<div class="code_background_color" ><code>&nbsp;&nbsp;table&nbsp;initialize( nute facts, // Nutritional facts, source: ndb.nal.usda.gov<br/>
&nbsp;&nbsp;{&nbsp;&nbsp;{&nbsp;&nbsp;Food,&nbsp;Ingredient, Portion&nbsp;&nbsp;},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;potato&nbsp;chips,&nbsp;&nbsp;fat,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.34&nbsp;&nbsp;},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;potato&nbsp;chips,&nbsp;&nbsp;carbohydrates,&nbsp;&nbsp;0.50&nbsp;&nbsp;},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;potato&nbsp;chips,&nbsp;&nbsp;sodium,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.08&nbsp;&nbsp;},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;potato&nbsp;chips,&nbsp;&nbsp;proteins,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.07&nbsp;&nbsp;},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;potato&nbsp;chips,&nbsp;&nbsp;others,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;}, // Remaining weight subtracted from above (--&gt; operation identifer 'mul')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;broccoli,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;water,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.90&nbsp;&nbsp;},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;broccoli,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proteins,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.03&nbsp;&nbsp;},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;broccoli,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;carbohydrates,&nbsp;&nbsp;0.06&nbsp;&nbsp;},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;broccoli,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;others,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;},&nbsp;// Remaining weight subtracted from above (--&gt; operation identifer 'mul')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;spring&nbsp;water,&nbsp;&nbsp;water,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.00&nbsp;&nbsp;} } );<br/>
<br/>
&nbsp;&nbsp;table&nbsp;initialize( target, { { Name, Favorite Food, Weight },<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;Rafael, Broccoli,&nbsp;&nbsp;&nbsp;&nbsp;200 }, { Steve, Parmesan cheese, 100 },<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;George, Potato chips, 50 }, { Fred,&nbsp;&nbsp;Spring water,&nbsp;&nbsp;&nbsp;1000 } } );<br/>
<br/>
<br/>
&nbsp;&nbsp;echo("Target&nbsp;table before looking up with expanding contents:");<br/>
&nbsp;&nbsp;table&nbsp;list ( target );<br/>
<br/>
&nbsp;&nbsp;table&nbsp;expand fast ignore case( target, Favorite Food, { Ingredient, Weight }, nute facts, Food, { Ingredient, Portion }, { overwrite, mul} );<br/>
<br/>
&nbsp;&nbsp;//&nbsp;Note that food portions are multiplied with the weight of the food.<br/>
&nbsp;&nbsp;//&nbsp;Additional rows are put to the end of the table.<br/>
<br/>
&nbsp;&nbsp;echo("After&nbsp;expanding (listing ingredients and calculating their weights):");<br/>
&nbsp;&nbsp;table&nbsp;list ( target );<br/>
</code></div>
<h4> Output</h4>
<div class="output_background_color" ><code>Target&nbsp;table&nbsp;before&nbsp;looking&nbsp;up&nbsp;with&nbsp;expanding&nbsp;contents:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;:&nbsp;Name&nbsp;&nbsp;&nbsp;|&nbsp;Favorite&nbsp;Food&nbsp;&nbsp;&nbsp;|&nbsp;Weight<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;:&nbsp;Rafael&nbsp;|&nbsp;Broccoli&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;200&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;:&nbsp;Steve&nbsp;&nbsp;|&nbsp;Parmesan&nbsp;cheese&nbsp;|&nbsp;100&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;:&nbsp;George&nbsp;|&nbsp;Potato&nbsp;chips&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;50&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;:&nbsp;Fred&nbsp;&nbsp;&nbsp;|&nbsp;Spring&nbsp;water&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1000&nbsp;&nbsp;<br/>
<br/>
After&nbsp;expanding&nbsp;(listing&nbsp;ingredients&nbsp;and&nbsp;calculating&nbsp;their&nbsp;weights):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;:&nbsp;Name&nbsp;&nbsp;&nbsp;|&nbsp;Favorite&nbsp;Food&nbsp;&nbsp;&nbsp;|&nbsp;Weight&nbsp;|&nbsp;Ingredient&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;:&nbsp;Rafael&nbsp;|&nbsp;Broccoli&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;180&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;water&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;:&nbsp;Steve&nbsp;&nbsp;|&nbsp;Parmesan&nbsp;cheese&nbsp;|&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;:&nbsp;George&nbsp;|&nbsp;Potato&nbsp;chips&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;fat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;:&nbsp;Fred&nbsp;&nbsp;&nbsp;|&nbsp;Spring&nbsp;water&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1000&nbsp;&nbsp;&nbsp;|&nbsp;water&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;:&nbsp;Rafael&nbsp;|&nbsp;Broccoli&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;proteins&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;:&nbsp;Rafael&nbsp;|&nbsp;Broccoli&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;carbohydrates<br/>
&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;:&nbsp;Rafael&nbsp;|&nbsp;Broccoli&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;others&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;:&nbsp;George&nbsp;|&nbsp;Potato&nbsp;chips&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;25&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;carbohydrates<br/>
&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;:&nbsp;George&nbsp;|&nbsp;Potato&nbsp;chips&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;sodium&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;10&nbsp;:&nbsp;George&nbsp;|&nbsp;Potato&nbsp;chips&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;3.5&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;proteins&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;11&nbsp;:&nbsp;George&nbsp;|&nbsp;Potato&nbsp;chips&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;0.5&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;others&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
</code></div><u>Try it yourself:</u> Open <b>REF_Function_table_expand_fast.b4p</b> in <a class="bold_text" href="B4P_Examples.zip">B4P_Examples.zip</a>. Decompress before use.
<h4> See also</h4>
<p><a class = "bold_text" href="REF_Function_table_expand.html">table expand</a><br/>
<a class = "bold_text" href="REF_Function_table_expand_smart.html">table expand smart</a><br/>
<a class = "bold_text" href="REF_Function_table_expand_fast_smart.html">table expand fast smart</a><br/>
<a class = "bold_text" href="REF_Function_table_integrate.html">table integrate</a><br/>
<a class = "bold_text" href="REF_Function_table_lookup.html">table lookup</a></p>
	</div>
</section>

<div class="footer">
Copyright (C) 2007 - 2020 Georg zur Bonsen, All Rights Reserved
</div>

</div>

</html>	


