<!DOCTYPE html>
<html lang="en-US">	

<head>
<meta charset="utf-8"/>
<title>B4P Reference</title>
<link rel="stylesheet" href="styles.css">
</head>


<div class="wrapper">

<div class="logo">
<a href="index.html">
<img src="Images/B4P_Logo.png" alt="B4P">
</a>
</div>

<div class="header">
<h3>table validate</h3>
<a accesskey="p" href="LIB_Function_(This_is_a_user-defined_function_you_need_to_create).html"><span>Prev</span></a> <a accesskey="n" href="LIB_Features_table_validate_-_row_results.html"><span>Next</span></a> 
</div>

<section>
	<div class="nav">
<div class="booktitle_field">Function Library Guide</div>
<ul>
<li class="navi"><a href="GUI_Features_User_Guide.html"><div class="navi"> &#8594; User Guide </div></a></li>
<li class="navi"><a href="LAN_Features_Language_Guide.html"><div class="navi"> &#8594; Language Guide </div></a></li>
<li class="navi"><a href="LIB_Features_Table_of_Contents.html"><div class="navi"> Table of Contents </div></a></li>
<li class="navi"><a href="LIB_Features_Function_Library.html"><div class="navi">1 Function Library </div></a></li>
<li class="navi"><a href="LIB_Features_Control_flow_functions.html"><div class="navi">+ 2 Control Flow Functions </div></a></li>
<li class="navi"><a href="LIB_Features_Console_I_O_Functions.html"><div class="navi">+ 3 Console I/O Functions </div></a></li>
<li class="navi"><a href="LIB_Features_Type_Conversion_Functions.html"><div class="navi">+ 4 Type Conversion and Formatting </div></a></li>
<li class="navi"><a href="LIB_Features_Mathematics_and_Statistics.html"><div class="navi">+ 5 Mathematics and Statistics </div></a></li>
<li class="navi"><a href="LIB_Features_string_functions.html"><div class="navi">+ 6 String Functions </div></a></li>
<li class="navi"><a href="LIB_Features_date_and_time_functions.html"><div class="navi">+ 7 Date and Time Functions </div></a></li>
<li class="navi"><a href="LIB_Features_parameter_set_functions.html"><div class="navi">+ 8 Parameter Set Functions </div></a></li>
<li class="navi"><a href="LIB_Features_table_functions.html"><div class="navi">9 Table Functions </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="LIB_Features_Loading_and_saving_tables.html"><div class="navi">+ 9.1 Loading and Saving Tables </div></a></li>
<li class="navi"><a href="LIB_Features_Console_I_O_with_tables.html"><div class="navi">+ 9.2 Console I/O with Tables </div></a></li>
<li class="navi"><a href="LIB_Features_Create___read___write___delete_tables.html"><div class="navi">+ 9.3 Creating, Writing, Reading, Deleting </div></a></li>
<li class="navi"><a href="LIB_Features_Accessing_table_information.html"><div class="navi">+ 9.4 Accessing Table Information </div></a></li>
<li class="navi"><a href="LIB_Features_Searching_and_exploring_tables.html"><div class="navi">+ 9.5 Searching and Exploring Tables </div></a></li>
<li class="navi"><a href="LIB_Features_Control_Flow_Functions_for_Tables.html"><div class="navi">+ 9.6 Control Flow Functions for Tables </div></a></li>
<li class="navi"><a href="LIB_Features_Processing_tables.html"><div class="navi">+ 9.7 Processing Tables </div></a></li>
<li class="navi"><a href="LIB_Features_Multi-table_integration.html"><div class="navi">9.8 Multi-Table Integration </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="LIB_Features_Comparing_and_validating_tables.html"><div class="navi">9.8.1 Comparing and Validating Tables </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="LIB_Function_table_compare.html"><div class="navi">+ 9.8.1.1 table compare ... </div></a></li>
<li class="navi"><a href="LIB_Function_table_validate.html"><div class="navi navi-selected">9.8.1.2 table validate </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="LIB_Features_table_validate_-_row_results.html"><div class="navi">9.8.1.2.1 table validate - Row and Group Results </div></a></li>
<li class="navi"><a href="LIB_Features_table_validate_-_examples.html"><div class="navi">9.8.1.2.2 table validate - Examples </div></a></li>
</ul></li>
<li class="navi"><a href="LIB_Function_table_check_duplicates.html"><div class="navi">9.8.1.3 table check duplicates ... </div></a></li>
</ul></li>
<li class="navi"><a href="LIB_Features_Looking_up_other_tables.html"><div class="navi">+ 9.8.2 Looking up Other Tables </div></a></li>
<li class="navi"><a href="LIB_Features_Combining_multiple_tables.html"><div class="navi">+ 9.8.3 Combining Multiple Tables </div></a></li>
</ul></li>
<li class="navi"><a href="LIB_Features_Formatting_and_styling_tables.html"><div class="navi">+ 9.9 Formatting and Styling Tables </div></a></li>
</ul></li>
<li class="navi"><a href="LIB_Features_variables_functions.html"><div class="navi">+ 10 Variables Functions </div></a></li>
<li class="navi"><a href="LIB_Features_directory_and_file_system_functions.html"><div class="navi">+ 11 Directory and File System Functions </div></a></li>
<li class="navi"><a href="LIB_Features_system_functions.html"><div class="navi">+ 12 System Functions </div></a></li>
<li class="navi"><a href="LIB_Features_help_and_support_functions.html"><div class="navi">+ 13 Help and Support Functions </div></a></li>
<li class="navi"><a href="LIB_Features_Cross-functional_info.html"><div class="navi">+ 14 Cross-Functional Info </div></a></li>
<li class="navi"><a href="LIB_Features_Index.html"><div class="navi">15 Index </div></a></li>
</ul>
	</div>

	<div class="article">
<h4> Function Names</h4>
<div class="white_background_color" ><code>table validate</code></div>
<h4> Description</h4>
<p>
This function checks and validates the target table against a rules table which contains values, rules (<a class="bold_text" href="LAN_Features_Comparison_Expression_[func._params].html">comparison expressions</a>) and optionally more advanced verification
expressions. This function can check for the following:
</p><ul class="bullets"><li class="bullets">Contents in selected columns comply with rules specified (e.g. is equal to, contains , etc. )
</li><li class="bullets">Optionally, the number of rows in the target table is checked (for minimum required, maximum allowed, etc.)
</li></ul><p>
This function requires at least 3 parameters:
</p><ul class="bullets"><li class="bullets">The names of both tables (target and reference etables), and
</li><li class="bullets">The columns to be checked (target data in target table, checking comparison expressions in the reference table).
</li></ul><p>
In the target table, the following four columns will be added with header names as listed below if they are not yet existing.
If they exist, contents will overwritten, and "Explanations" appended.

</p><table class="noframe bold_column_1" style = "width:1000px"><col style = "width:300px"><col style = "width:700px">
<tr><td>Row Result          </td><td> Comparison result statement related to particular row.  See <span class="red_text">validating tables row results</span>.</td></tr>
<tr><td>Group Result        </td><td> Result related to entire group  See <span class="red_text">validating tables group results</span>.</td></tr>
<tr><td>Explanations        </td><td> Details about mismatch. In case multiple mismatches,  exist, only the first mismatch will be explained</td></tr>
<tr><td>Ref Row             </td><td> Identified row number in the reference table where the comparison has been made.</td></tr>
</table><p>

The reference table contains rows which are being used to validate the contents in the target table.
For entries in the target table, 1 or more corresponding rows may be specified in the reference table.
As long all conditions in the columns are met in at least one of the rows, then the validation result is OK.

<br><br>

<u>Note:</u> The sequential order of the rows in the target table as well as in the reference table do not matter.
Grouped rows do not need to lie in blocks of adjacent rows and may be scattered throughout the entire table.


</p>
<h4> Call as: <span class="black_text">procedure or function</span></h4>
<h4> Restrictions</h4>
<p>Indirect parameter passing is disabled</p>
<h4> Parameter count</h4>
<p>4 - 7</p>
<h4> Parameters</h4>
<table class="simple"><col style = "width:80px"><col style = "width:120px"><col style = "width:800px"><tr><th>No.</th><th>Type</th><th>Description</th></tr>
<tr><td>1.<br/>input</td>
<td>literal</td>
<td><b>Name of target table</b><br/><p>This table will be checked and validated</p>
</td></tr>
<tr><td>2.<br/>input</td>
<td>literal</td>
<td><b>Name of reference table</b><br/><p>The table contains the rules to apply for the validation procedure</p>
</td></tr>
<tr><td>3.<br/>input</td>
<td>table columns</td>
<td><b>Columns with data to be validated (both target and reference tables)</b><br/><p>See <a class="bold_text" href="LAN_Features_Table_columns.html">table columns as function parameters</a> for general ruling for this parameter.<br>
Specific rules apply for this function:
</p><ul class="bullets"><li class="bullets">Any number of header names and column numbers may be specified
</li><li class="bullets">The header names and column numbers are applicable to both target and reference table.
</li></ul><p>The columns in the target table containing values to be checked will be checked against the corresponding columns in the
reference table containing comparison expressions. The columns do not need to be in the same location or order if they
are referenced by their header names.
<br><br>
In the target table, the columns where the data needs to be checked must be selected.  In the reference table, the checking rules
(contains <a class="bold_text" href="LAN_Features_Comparison_Expression_[func._params].html">comparison expressions</a>) are located in the corresponding columns.
</p>
</td></tr>
<tr><td>Opt. 4.<br/>input</td>
<td>table columns</td>
<td><b>Columns with Row Match Identifiers (both target and reference tables)</b><br/><p>See <a class="bold_text" href="LAN_Features_Table_columns.html">table columns as function parameters</a> for general ruling for this parameter.<br>
Specific rules apply for this function:
</p><ul class="bullets"><li class="bullets">Any number of header names and column numbers may be specified
</li><li class="bullets">The header names and column numbers are applicable to both target and reference table.
</li><li class="bullets">Specify '' (softquoted blank) or {} (empty set) to skip this parameter.
</li></ul><p>In the reference table, only the rows with the same row match header will be compared instead of the entire table.</p>
<span class="black_text"><b> Default value: </b></span>{} (no columns specified)
</td></tr>
<tr><td>Opt. 5.<br/>input</td>
<td>table columns</td>
<td><b>Columns with Group Identifiers (in the target table)</b><br/><p>See <a class="bold_text" href="LAN_Features_Table_columns.html">table columns as function parameters</a> for general ruling for this parameter.<br>
Specific rules apply for this function:
</p><ul class="bullets"><li class="bullets">Any number of header names and column numbers may be specified
</li><li class="bullets">The header names and column numbers are applicable to both target and reference table.
</li><li class="bullets">Specify '' (softquoted blank) or {} (empty set) to skip this parameter.
</li></ul><p></p>
<span class="black_text"><b> Default value: </b></span>{} (no columns specified)
</td></tr>
<tr><td>Opt. 6.<br/>input</td>
<td>table columns</td>
<td><b>Columns with Group Match Identifiers (target and reference table)</b><br/><p>See <a class="bold_text" href="LAN_Features_Table_columns.html">table columns as function parameters</a> for general ruling for this parameter.<br>
Specific rules apply for this function:
</p><ul class="bullets"><li class="bullets">Any number of header names and column numbers may be specified
</li><li class="bullets">The header names and column numbers are applicable to both target and reference table.
</li><li class="bullets">Specify '' (softquoted blank) or {} (empty set) to skip this parameter.
</li></ul><p>All rows with the same Group Identifiers are allocated to one group.
This parameter actually selects the rows in the reference table to be used for comparison.
</p>
<span class="black_text"><b> Default value: </b></span>{} (no columns specified)
</td></tr>
<tr><td>Opt. 7.<br/>input</td>
<td>table column</td>
<td><b>Columns with Group Match Identifiers (in the reference table)</b><br/><p>See <a class="bold_text" href="LAN_Features_Table_columns.html">table columns as function parameters</a> for general ruling for this parameter.<br>
Specific rules apply for this function:
</p><ul class="bullets"><li class="bullets">At most one header name or column number may be specified
</li><li class="bullets">The header names and column numbers are applicable to both target and reference table.
</li><li class="bullets">Specify '' (softquoted blank) or {} (empty set) to skip this parameter.
</li></ul><p>The contents below this header contains B4P <span class="red_text">expressions </span> which must reurn boolean results.
These expressions allow more advanced validation schemes and may reference to all columns in the target table using
<a class="bold_text" href="LAN_Features_partial_table_specifications.html">partial table specifications</a>.
</p>
<span class="black_text"><b> Default value: </b></span>{} (no columns specified)
</td></tr>
<tr><td>Opt. 8.<br/>input</td>
<td>table column</td>
<td><b>Column with Comparison Directions (reference table) for validation of within a group</b><br/><p>See <a class="bold_text" href="LAN_Features_Table_columns.html">table columns as function parameters</a> for general ruling for this parameter.<br>
Specific rules apply for this function:
</p><ul class="bullets"><li class="bullets">At most one header name or column number may be specified
</li><li class="bullets">The header names and column numbers are applicable to both target and reference table.
</li><li class="bullets">Specify '' (softquoted blank) or {} (empty set) to skip this parameter.
</li></ul><p>
In the reference table, the data below this header may contain the following values:

</p><table class="noframe_1stcolbold" style = "width:800px"><col style = "width:100px"><col style = "width:700px">
<tr><td>min 0       </td><td> This row may be checked 0, 1 or multiple times. This option imposes no restrictions on how many time the comparison is made.  It is the default setting if this parameter is not supplied to this function.</td></tr>
<tr><td>equal 0     </td><td> This row must not be checked at all.  Error asserted if this row has been matched.  Useful to check for table entries which are not supposed to exist.</td></tr>
<tr><td>min 1       </td><td> This row must be checked at least once or more</td></tr>
<tr><td>equal 1     </td><td> This row must be checked precisely once</td></tr>
<tr><td>max 1       </td><td> This row may be checked 0 or 1 times</td></tr>
</table><p></p>
<span class="black_text"><b> Default value: </b></span>{} (no columns specified) - Value 'min 0' applies for all rows
</td></tr>
<tr><td>Opt. 9.<br/>code</td>
<td>expression<br/>:literal</td>
<td><b>Expression to select rows</b><br/><p>Specify the conditions or rules to select the row.  See <a class="bold_text" href="LAN_Features_Expression_to_select_rows.html">expressions to select rows</a>.<br>
<a class="bold_text" href="LAN_Features_partial_table_specifications.html">Partial table specification</a> is supported here to reference table columns easily.  Example: <b>[Score]>=5</b>.<br>
<u>Attention</u>: If you are using comparison operators = and <> (instead of == and !=) which allow more than 1 operand on the righ hand side, then make sure you put the entire expression into parentheses.  Otherwise the operators will hijack subsequent function parameters as part of their operands.</p>
</td></tr>
</table>
<h4> Return value</h4>
<table class="simple"><col style = "width:120px"><col style = "width:880px"><tr><th>Type</th><th>Description</th></tr>
<tr>
<td>boolean</td>
<td><b>Table is OK</b><br/><p>true if no mismatches identified.  Otherwise false.</p></td></tr>
</table>
<h4> Examples</h4>
<div class="code_background_color" ><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table initialize( target, {{ Name, Gender}, { Philippe, male }, { Pascale, female }, { Michele, female }} );<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo("Target table:"); table list ( target );<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table initialize( reference, { Gender, male, female }&nbsp;&nbsp;);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo("Reference table:"); table list ( reference );<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res[] = table validate( target, reference, Gender );<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo("Target table after validation (result = ", res[], "):");<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table list ( target );<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo("Add a mistake.");<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[target:Name,Philippe,Gender] = "Male"; // Upper case deviates<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res[] = table validate( target, reference, Gender );<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo("Target table after validation (result = ", res[], "):");<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table list ( target );<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// See following sub-sections for more sophisticated examples.</code></div>
<h4> Output</h4>
<div class="output_background_color" ><code>Target table:<br>&nbsp;&nbsp;&nbsp;&nbsp;0 : Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| Gender<br>&nbsp;&nbsp;&nbsp;&nbsp;1 : Philippe | male&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;2 : Pascale&nbsp;&nbsp;| female<br>&nbsp;&nbsp;&nbsp;&nbsp;3 : Michele&nbsp;&nbsp;| female<br><br>Reference table:<br>&nbsp;&nbsp;&nbsp;&nbsp;0 : Gender<br>&nbsp;&nbsp;&nbsp;&nbsp;1 : male&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;2 : female<br><br>Target table after validation (result = true):<br>&nbsp;&nbsp;&nbsp;&nbsp;0 : Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| Gender | Row Result | Group Result | Explanations | Ref Row<br>&nbsp;&nbsp;&nbsp;&nbsp;1 : Philippe | male&nbsp;&nbsp;&nbsp;| OK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| OK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;2 : Pascale&nbsp;&nbsp;| female | OK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| OK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;3 : Michele&nbsp;&nbsp;| female | OK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| OK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><br>Add a mistake.<br>Target table after validation (result = false):<br>&nbsp;&nbsp;&nbsp;&nbsp;0 : Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| Gender | Row Result | Group Result | Explanations&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| Ref Row<br>&nbsp;&nbsp;&nbsp;&nbsp;1 : Philippe | Male&nbsp;&nbsp;&nbsp;| Mismatch&nbsp;&nbsp;&nbsp;| Not OK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [Gender] = 'male'?&nbsp;&nbsp;&nbsp;| 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [Gender] = 'female'? |<br>&nbsp;&nbsp;&nbsp;&nbsp;2 : Pascale&nbsp;&nbsp;| female | OK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| Not OK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;3 : Michele&nbsp;&nbsp;| female | OK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| Not OK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><br></code></div><u>Try it yourself:</u> Open <b>LIB_Function_table_validate.b4p</b> in <a class="bold_text" href="B4P_Examples.zip">B4P_Examples.zip</a>. Decompress before use.
	</div>
</section>

<div class="footer">
Copyright (C) 2007 - 2021 Georg zur Bonsen, All Rights Reserved
</div>

</div>

</html>	


