<!DOCTYPE html>
<html lang="en-US">	

<head>
<meta charset="utf-8"/>
<title>B4P Reference</title>
<link rel="stylesheet" href="styles.css">
</head>


<div class="wrapper">

<div class="logo">
<a href="index.html">
<img src="Images/B4P_Logo.png" alt="B4P">
</a>
</div>

<div class="header">
<h3>Interpolation Functions</h3>
<a accesskey="p" href="LIB_Function_regression.html"><span>Prev</span></a> <a accesskey="n" href="LIB_Features_Interpolation_Examples.html"><span>Next</span></a> 
</div>

<section>
	<div class="nav">
<div class="booktitle_field">Function Library Guide</div>
<ul>
<li class="navi"><a href="LIB_Features_Table_of_Contents.html"><div class="navi"> Table of Contents </div></a></li>
<li class="navi"><a href="LIB_Features_Function_Library.html"><div class="navi"> Function Library </div></a></li>
<li class="navi"><a href="LIB_Features_Control_flow_functions.html"><div class="navi">+  Control Flow Functions </div></a></li>
<li class="navi"><a href="LIB_Features_Console_I_O_Functions.html"><div class="navi">+  Console I/O Functions </div></a></li>
<li class="navi"><a href="LIB_Features_Type_Conversion_Functions.html"><div class="navi">+  Type Conversion and Formatting </div></a></li>
<li class="navi"><a href="LIB_Features_Mathematics_and_Statistics.html"><div class="navi"+>-  Mathematics and Statistics </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="LIB_Features_basic_math_functions.html"><div class="navi">+  Basic Math Functions </div></a></li>
<li class="navi"><a href="LIB_Features_transcendental_functions.html"><div class="navi">+  Transcendental Functions </div></a></li>
<li class="navi"><a href="LIB_Features_series_functions.html"><div class="navi">+  Series Functions </div></a></li>
<li class="navi"><a href="LIB_Features_matrix_functions.html"><div class="navi">+  Matrix Functions </div></a></li>
<li class="navi"><a href="LIB_Features_statistics_functions.html"><div class="navi"+>-  Statistics Functions </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="LIB_Function_average.html"><div class="navi">    Basic Statistics Functions </div></a></li>
<li class="navi"><a href="LIB_Function_quantile.html"><div class="navi">    quantile ... </div></a></li>
<li class="navi"><a href="LIB_Function_covariance.html"><div class="navi">    covariance, correlation </div></a></li>
<li class="navi"><a href="LIB_Function_gini.html"><div class="navi">    gini Coefficient Functions </div></a></li>
<li class="navi"><a href="LIB_Function_regression.html"><div class="navi">    Linear and Exponential Regression </div></a></li>
<li class="navi"><a href="LIB_Function_linear_interpolation.html"><div class="navi navi-selected"+>-  Interpolation Functions </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="LIB_Features_Interpolation_Examples.html"><div class="navi">    Interpolation Examples Visualized </div></a></li>
</ul></li>
<li class="navi"><a href="LIB_Function_histogram.html"><div class="navi">    histogram </div></a></li>
</ul></li>
<li class="navi"><a href="LIB_Function_sum_if.html"><div class="navi">    Conditional Combination Functions </div></a></li>
<li class="navi"><a href="LIB_Features_finance_functions.html"><div class="navi">+  Finance and Business Functions </div></a></li>
</ul></li>
<li class="navi"><a href="LIB_Features_string_functions.html"><div class="navi">+  String Functions </div></a></li>
<li class="navi"><a href="LIB_Features_date_and_time_functions.html"><div class="navi">+  Date and Time Functions </div></a></li>
<li class="navi"><a href="LIB_Features_Set_functions.html"><div class="navi">+  Set Functions </div></a></li>
<li class="navi"><a href="LIB_Features_table_functions.html"><div class="navi">+  Table Functions </div></a></li>
<li class="navi"><a href="LIB_Features_variables_functions.html"><div class="navi">+  Variables Functions </div></a></li>
<li class="navi"><a href="LIB_Features_directory_and_file_system_functions.html"><div class="navi">+  Directory and File System Functions </div></a></li>
<li class="navi"><a href="LIB_Features_system_functions.html"><div class="navi">+  System Functions </div></a></li>
<li class="navi"><a href="LIB_Features_help_and_support_functions.html"><div class="navi">+  Help and Support Functions </div></a></li>
<li class="navi"><a href="LIB_Features_Cross-functional_info.html"><div class="navi">+  Cross-Functional Info </div></a></li>
<li class="navi"><div>  </div></li>
<li class="navi"><div>  </div></li>
<li class="navi"><div>  </div></li>
<li class="navi"><a href="GUI_Features_User_Guide.html"><div class="navi"> &#8594; User Guide </div></a></li>
<li class="navi"><a href="LAN_Features_Language_Guide.html"><div class="navi"> &#8594; Language Guide </div></a></li>
<li class="navi"><a href="TAB_Features_Processing_Tables_and_Big_Data.html"><div class="navi"> &#8594; Tables and Big Data </div></a></li>
<li class="navi"><div>  </div></li>
<li class="navi"><a href="LIB_Features_Index.html"><div class="navi"> Index </div></a></li>
</ul>
	</div>

	<div class="article">
<h4> Function Names</h4>
<div class="white_background_color" ><code>linear interpolation, nearest neighbor interpolation, nearest right neighbor interpolation, spline interpolation, polynomial interpolation</code></div>
<h4> Description</h4>
<p>
These functions calculate a value based on known points in a 2-dimensional space by applying one of the following interpolation schemes:
</p><table class="bold_column_1" style = "width:700px"><col style = "width:200px"><col style = "width:500px">
<tr><th>Function name                                   </th><th> Description</th></tr>
<tr><td>linear interpolation                    </td><td> Straight lines are drawn between the points</td></tr>
<tr><td>nearest neighbor interpolation  </td><td> Staircase pattern: Y-value takes value of nearest neighbor. If both distances are equal, then the nearest left neighbor is chosen.</td></tr>
<tr><td>nearest right neighbor interpolation </td><td>  Same as above, nearest right neighbor chosen if distances are equal.</td></tr>
<tr><td>spline interpolation                    </td><td> Natural cubic spline interpolation</td></tr>
<tr><td>polynomial interpolation                </td><td> Creates n-th order polynomial (n = number of points - 1) which passes through all specified points.</td></tr>
</table><p>

All interpolation functions ensure that the calculated lines cross the specified points.  If discontinuities are undesirable, use spine or polynomial interpolation.
Note that the polynomial interpolation create some oscillation effects between the outer 2-3 points at the beginning and at the end.
The spline interpolation does not have this problem.

<br><br>See <a class="bold_text" href="LIB_Features_Interpolation_Examples.html">interpolation examples</a> with visualized charts.
</p>
<h4> Call as: <span class="black_text">function</span></h4>
<h4> Restrictions</h4>
<p>Indirect parameter passing is disabled</p>
<h4> Parameter count</h4>
<p>3-5</p>
<h4> Parameters</h4>
<table class="simple"><col style = "width:80px"><col style = "width:120px"><col style = "width:800px"><tr><th>No.</th><th>Type</th><th>Description</th></tr>
<tr><td>1<br/>input</td>
<td>numeral<br/>set of numerals</td>
<td><b>X-values</b><br/><p>One or more X-values provided in order to calculate one or more Y-values</p>
</td></tr>
<tr><td>2<br/>input</td>
<td>set of numerals</td>
<td><b>X-coordinates of points</b><br/><p>The list of known points consist of X-coordinates provided in this function parameter and Y-coordinates in the next function parameter.</p>
</td></tr>
<tr><td>3<br/>input</td>
<td>set of numerals</td>
<td><b>X-coordinates of points</b><br/><p>The list of known points consist of X-coordinates provided in the previous function parameter and Y-coordinates in this function parameter.  The X-values must be in ascending order.</p>
</td></tr>
<tr><td>Opt. 4<br/>input</td>
<td>string</td>
<td><b>Extrapolation options beyond left side</b><br/><p>Extrapolation option left side (and also applicable to beyond the right side if the 5th parameter is not specified). Following options exist:
</p><table class="noframe bold_column_1" style = "width:600px"><col style = "width:100px"><col style = "width:500px">
<tr><td>reject                </td><td> Assert an error if the X value lies outside the interpolation range</td></tr>
<tr><td>flat                  </td><td> Continue with flat value (extended with a horizontal line)</td></tr>
<tr><td>continue               </td><td> Continue with using same formula for extrapolation:<br>nearest (right) neighbor interpolation:  flat (horizontal line)<br>linear interpolation: continue with same slope<br>spline / polynomial interpolation: use same formula.<br>                                            <u>Note:</u> spline and polynomial interpolation will result in over / under-shooting effects outside the interpolation points.  Use them carefully.</td></tr>
<tr><td>zero                  </td><td> Zero returned</td></tr>
<tr><td><i>numeral</i></td><td> Apply line with specific slope.  Using 0 has same effect as <b>flat</b> (and not <b>zero</b>).</td></tr>
</table><p></p>
<span class="black_text"><b> Default value: </b></span>reject
</td></tr>
<tr><td>Opt. 5<br/>input</td>
<td>string</td>
<td><b>Extrapolation options beyond right side</b><br/><p>Extrapolation option right side.  Same value selection as defined for the 4th aprameter (extrapolation options beyond left side).</p>
<span class="black_text"><b> Default value: </b></span>same as specified in 4th parameter, otherwise reject
</td></tr>
</table>
<h4> Return value</h4>
<table class="simple"><col style = "width:120px"><col style = "width:880px"><tr><th>Type</th><th>Description</th></tr>
<tr>
<td>numeral<br/>set of numerals</td>
<td><b>Result</b><br/><p>Calculated Y-value (or Y-values if set with multiple numerals are passed into 1st function parameter).</p></td></tr>
</table>
<h4> Exceptions</h4>
<p>Rejected extrapolation<br/>
X-values not in ascending order<br/>
Empty sets or sets of different lengths provided for X- and/or Y-coordinates</p>
<h4> Examples</h4>
<div class="code_background_color" ><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x[] = {-1 .. 12 };<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[] = linear interpolation( x[], {0, 4, 8, 10}, {0, 8, 5, 0}, flat, continue );<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Note: Extrapolation is done for for x[] = -1, 11 and 12.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo(y[]);</code></div>
<h4> Output</h4>
<div class="output_background_color" ><code>{0,0,2,4,6,8,7.25,6.5,5.75,5,2.5,0,-2.5,-5}<br></code></div><u>Try it yourself:</u> Open <b>LIB_Function_linear_interpolation.b4p</b> in <a class="bold_text" href="B4P_Examples.zip">B4P_Examples.zip</a>. Decompress before use.
<h4> See also</h4>
<p><a class = "bold_text" href="LIB_Features_Interpolation_Examples.html">Interpolation Examples</a></p>
	</div>
</section>

<div class="footer">
Copyright (C) 2007 - 2024 Georg A. zur Bonsen, All Rights Reserved
</div>

</div>

</html>	


