<!DOCTYPE html>
<html lang="en-US">	

<head>
<meta charset="utf-8"/>
<title>B4P Reference</title>
<link rel="stylesheet" href="styles.css">
</head>


<div class="wrapper">

<div class="logo">
<a href="index.html">
<img src="Images/B4P_Logo.png" alt="B4P">
</a>
</div>

<div class="header">
<h3>table (write or) add missing row</h3>
<a accesskey="p" href="LIB_Function_table_add_row.html"><span>Prev</span></a> <a accesskey="n" href="LIB_Function_table_write_column_selected_rows.html"><span>Next</span></a> 
</div>

<section>
	<div class="nav">
<div class="booktitle_field">Function Library Guide</div>
<ul>
<li class="navi"><a href="GUI_Features_User_Guide.html"><div class="navi"> &#8594; User Guide </div></a></li>
<li class="navi"><a href="LAN_Features_Language_Guide.html"><div class="navi"> &#8594; Language Guide </div></a></li>
<li class="navi"><a href="LIB_Features_Table_of_Contents.html"><div class="navi"> Table of Contents </div></a></li>
<li class="navi"><a href="LIB_Features_Function_Library.html"><div class="navi">1 Function Library </div></a></li>
<li class="navi"><a href="LIB_Features_Control_flow_functions.html"><div class="navi">+ 2 Control Flow Functions </div></a></li>
<li class="navi"><a href="LIB_Features_Console_I_O_Functions.html"><div class="navi">+ 3 Console I/O Functions </div></a></li>
<li class="navi"><a href="LIB_Features_Type_Conversion_Functions.html"><div class="navi">+ 4 Type Conversion and Formatting </div></a></li>
<li class="navi"><a href="LIB_Features_Mathematics_and_Statistics.html"><div class="navi">+ 5 Mathematics and Statistics </div></a></li>
<li class="navi"><a href="LIB_Features_string_functions.html"><div class="navi">+ 6 String Functions </div></a></li>
<li class="navi"><a href="LIB_Features_date_and_time_functions.html"><div class="navi">+ 7 Date and Time Functions </div></a></li>
<li class="navi"><a href="LIB_Features_parameter_set_functions.html"><div class="navi">+ 8 Parameter Set Functions </div></a></li>
<li class="navi"><a href="LIB_Features_table_functions.html"><div class="navi">9 Table Functions </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="LIB_Features_Loading_and_saving_tables.html"><div class="navi">+ 9.1 Loading and Saving Tables </div></a></li>
<li class="navi"><a href="LIB_Features_Console_I_O_with_tables.html"><div class="navi">+ 9.2 Console I/O with Tables </div></a></li>
<li class="navi"><a href="LIB_Features_Create___read___write___delete_tables.html"><div class="navi">9.3 Creating, Writing, Reading, Deleting </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="LIB_Features_Creating_tables_and_building_up_tables.html"><div class="navi">+ 9.3.1 Creating and Building up Tables </div></a></li>
<li class="navi"><a href="LIB_Features_Functions_for_writing_tables.html"><div class="navi">9.3.2 Writing Tables </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="LIB_Function_table_append.html"><div class="navi">9.3.2.1 table append ... </div></a></li>
<li class="navi"><a href="LIB_Function_table_append_blank_rows.html"><div class="navi">9.3.2.2 table append blank rows </div></a></li>
<li class="navi"><a href="LIB_Function_table_add_row.html"><div class="navi">9.3.2.3 table add / write row </div></a></li>
<li class="navi"><a href="LIB_Function_table_add_missing_row.html"><div class="navi navi-selected">9.3.2.4 table (write or) add missing row </div></a></li>
<li class="navi"><a href="LIB_Function_table_write_column_selected_rows.html"><div class="navi">9.3.2.5 table write column selected rows </div></a></li>
</ul></li>
<li class="navi"><a href="LIB_Features_Functions_for_reading_tables.html"><div class="navi">+ 9.3.3 Reading Tables </div></a></li>
<li class="navi"><a href="LIB_Features_Clearing_and_deleting_tables.html"><div class="navi">+ 9.3.4 Deleting Tables </div></a></li>
</ul></li>
<li class="navi"><a href="LIB_Features_Accessing_table_information.html"><div class="navi">+ 9.4 Accessing Table Information </div></a></li>
<li class="navi"><a href="LIB_Features_Searching_and_exploring_tables.html"><div class="navi">+ 9.5 Searching and Exploring Tables </div></a></li>
<li class="navi"><a href="LIB_Features_Control_Flow_Functions_for_Tables.html"><div class="navi">+ 9.6 Control Flow Functions for Tables </div></a></li>
<li class="navi"><a href="LIB_Features_Processing_tables.html"><div class="navi">+ 9.7 Processing Tables </div></a></li>
<li class="navi"><a href="LIB_Features_Multi-table_integration.html"><div class="navi">+ 9.8 Multi-Table Integration </div></a></li>
<li class="navi"><a href="LIB_Features_Formatting_and_styling_tables.html"><div class="navi">+ 9.9 Formatting and Styling Tables </div></a></li>
</ul></li>
<li class="navi"><a href="LIB_Features_variables_functions.html"><div class="navi">+ 10 Variables Functions </div></a></li>
<li class="navi"><a href="LIB_Features_directory_and_file_system_functions.html"><div class="navi">+ 11 Directory and File System Functions </div></a></li>
<li class="navi"><a href="LIB_Features_system_functions.html"><div class="navi">+ 12 System Functions </div></a></li>
<li class="navi"><a href="LIB_Features_help_and_support_functions.html"><div class="navi">+ 13 Help and Support Functions </div></a></li>
<li class="navi"><a href="LIB_Features_Cross-functional_info.html"><div class="navi">+ 14 Cross-Functional Info </div></a></li>
<li class="navi"><a href="LIB_Features_Index.html"><div class="navi">15 Index </div></a></li>
</ul>
	</div>

	<div class="article">
<h4> Function Names</h4>
<div class="white_background_color" ><code>table add missing row, table write or add missing row</code></div>
<h4> Description</h4>
<p>
As a first step, the table will be checked if there is a match in the columns specified in the 2nd function parameter with
the data in the 3rd function parameter.  The comparison technique to find the corresponding table row is the same as
in the function <span class="red_text">table find</span>(), including wildcards supported.

<br><br>

If no matching row has been found, then a new row will be added with the columns and values provided in the 2nd and 3rd
function parameters, and, if avaiable, with the 4th and 5th function parameters, too.  Header names specified in the
4th function parameter which are still missing in the table will be created in order to include the data in the table.

<br><br>

However, if a matching row has been found, no futher actions happen if the function <b>table add missing row</b> is called,
or <b>table write or add missing row</b> with only 3 parameters is called (i.e. no further data to write).
Otherwise, the further data entries will be written to the table in the identified row.

</p>
<h4> Call as: <span class="black_text">procedure or function</span></h4>
<h4> Restrictions</h4>
<p>Indirect parameter passing is disabled</p>
<h4> Parameter count</h4>
<p>3 or 5</p>
<h4> Parameters</h4>
<table class="simple"><col style = "width:80px"><col style = "width:120px"><col style = "width:800px"><tr><th>No.</th><th>Type</th><th>Description</th></tr>
<tr><td>1.<br/>input</td>
<td>literal</td>
<td><b>name of new or existing table</b><br/><p>Table must be existing when using <b>table append...</b> functions.  Otherwise, it does not matter.</p>
</td></tr>
<tr><td>2<br/>input</td>
<td>table columns</td>
<td><b>Header names and/or column numbers to compare</b><br/><p>See <a class="bold_text" href="LAN_Features_Table_columns.html">table columns as function parameters</a> for general ruling for this parameter.<br>
Specific rules apply for this function:
</p><ul class="bullets"><li class="bullets">Any number of header names and column numbers may be specified</li></ul><p></p>
</td></tr>
<tr><td>3<br/>input</td>
<td>parameter set or literal</td>
<td><b>Comparison values or patterns</b><br/><p>The nummber of elements must match with the number of headers (2nd function parameter).
Specify the comparison patterns.<br>
</p><ul class="bullets"><li class="bullets">Unquoted or quoted literals as elements in parameter set: True comparison of contents without wildcards, e.g. { Name, "Street" }<br>
</li><li class="bullets">Softquoted literals in parameter set: You can use <a class="bold_text" href="LAN_Features_wildcards.html">wildcard symbols</a>, e.g. { '* Name', 'City,Town' }<br>
</li><li class="bullets">One quoted literal specifies just one item to compare, e.g. "Last Name"<br>
</li><li class="bullets">One softquoted literal converts the contents into a parameter set and treats contents as unquoted resp. quoted literals.</li></ul><p></p>
</td></tr>
<tr><td>Opt. 4.<br/>input</td>
<td>table columns</td>
<td><b>Further header names and/or column numbers to add</b><br/><p>See <a class="bold_text" href="LAN_Features_Table_columns.html">table columns as function parameters</a> for general ruling for this parameter.<br>
Specific rules apply for this function:
</p><ul class="bullets"><li class="bullets">Any number of header names and column numbers may be specified
</li><li class="bullets">Nonexisting header names will be added to the table</li></ul><p></p>
</td></tr>
<tr><td>Opt. 5<br/>input</td>
<td>parameter set</td>
<td><b>Further data to add or write</b><br/><p>All data written to the table must be put into parameter set and passed in this function parameter, even if only one
string value is provided.  The number of elements must not exceed the number of table columns specified but may be lower.
If fewer data elements are specified, then the remaining fields will not be overwritten.

<br><br>
Void values will not be written into the table.  You can actually use void values in order to prevent updating specific fields.</p>
</td></tr>
</table>
<h4> Return value</h4>
<table class="simple"><col style = "width:120px"><col style = "width:880px"><tr><th>Type</th><th>Description</th></tr>
<tr>
<td>numeral</td>
<td><b>Row number accessed</b><br/><p>Returns row number accessed.  If a row has been added, then it is the new row number at the end of the table.</p></td></tr>
</table>
<h4> Examples</h4>
<div class="code_background_color" ><code><br/>
&nbsp;&nbsp;table initialize ( t,<br/>
&nbsp;&nbsp;{ { Animal, leg count, size,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;intelligence },<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ Worm,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;very small,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;low},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ Worm,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;very small too,&nbsp;&nbsp;&nbsp;low},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ Fox,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quite small,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;medium } });<br/>
<br/>
<br/>
&nbsp;&nbsp;row[] = table write or add missing row( t, { Animal, size }, { Worm, very small too }, intelligence, { negligible } );<br/>
&nbsp;&nbsp;echo("Worm updated in row ", row[] );<br/>
<br/>
&nbsp;&nbsp;row[] = table write or add missing row( t, { Animal, size }, { Whale, huge }, intelligence, { quite high } );<br/>
&nbsp;&nbsp;echo("Whale added in row ", row[] );<br/>
<br/>
&nbsp;&nbsp;row[] = table write or add missing row( t, Animal, { Fox } ); //<br/>
&nbsp;&nbsp;echo("Fox is in row ", row[] );<br/>
<br/>
&nbsp;&nbsp;row[] = table add missing row( t, { Animal, leg count}, { Fox, 4 } ); // Already existing<br/>
&nbsp;&nbsp;echo("Fox with 4 legs already exists in in row ", row[] );<br/>
<br/>
&nbsp;&nbsp;row[] = table add missing row( t, { Animal, leg count}, { Fly, 6 }, { size }, { little } ); // Already existing<br/>
&nbsp;&nbsp;echo("Fly added in row ", row[] );<br/>
<br/>
&nbsp;&nbsp;echo;<br/>
&nbsp;&nbsp;table list ( t );</code></div>
<h4> Output</h4>
<div class="output_background_color" ><code>Worm updated in row 2<br>Whale added in row 4<br>Fox is in row 3<br>Fox with 4 legs already exists in in row 3<br>Fly added in row 5<br><br>&nbsp;&nbsp;&nbsp;&nbsp;0 : Animal | leg count | size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| intelligence<br>&nbsp;&nbsp;&nbsp;&nbsp;1 : Worm&nbsp;&nbsp;&nbsp;| 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| very small&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| low&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;2 : Worm&nbsp;&nbsp;&nbsp;| 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| very small too | negligible&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;3 : Fox&nbsp;&nbsp;&nbsp;&nbsp;| 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| quite small&nbsp;&nbsp;&nbsp;&nbsp;| medium&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;4 : Whale&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| huge&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| quite high&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;5 : Fly&nbsp;&nbsp;&nbsp;&nbsp;| 6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| little&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><br></code></div><u>Try it yourself:</u> Open <b>LIB_Function_table_add_missing_row.b4p</b> in <a class="bold_text" href="B4P_Examples.zip">B4P_Examples.zip</a>. Decompress before use.
<h4> See also</h4>
<p><a class = "bold_text" href="LIB_Function_table_add_row.html">table add row</a><br/>
<a class = "bold_text" href="LIB_Function_table_find_row.html">table find row</a></p>
	</div>
</section>

<div class="footer">
Copyright (C) 2007 - 2021 Georg zur Bonsen, All Rights Reserved
</div>

</div>

</html>	


