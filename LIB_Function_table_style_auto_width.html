<!DOCTYPE html>
<html lang="en-US">	

<head>
<meta charset="utf-8"/>
<title>B4P Reference</title>
<link rel="stylesheet" href="styles.css">
</head>


<div class="wrapper">

<div class="logo">
<a href="index.html">
<img src="Images/B4P_Logo.png" alt="B4P">
</a>
</div>

<div class="header">
<h3>table style auto width</h3>
<a accesskey="p" href="LIB_Features_Formatting_Precedences.html"><span>Prev</span></a> <a accesskey="n" href="LIB_Function_table_style_theme.html"><span>Next</span></a> 
</div>

<section>
	<div class="nav">
<div class="booktitle_field">Function Library Guide</div>
<ul>
<li class="navi"><a href="LIB_Features_Table_of_Contents.html"><div class="navi"> Table of Contents </div></a></li>
<li class="navi"><a href="LIB_Features_Function_Library.html"><div class="navi">1 Function Library </div></a></li>
<li class="navi"><a href="LIB_Features_Control_flow_functions.html"><div class="navi">+ 2 Control Flow Functions </div></a></li>
<li class="navi"><a href="LIB_Features_Console_I_O_Functions.html"><div class="navi">+ 3 Console I/O Functions </div></a></li>
<li class="navi"><a href="LIB_Features_Type_Conversion_Functions.html"><div class="navi">+ 4 Type Conversion and Formatting </div></a></li>
<li class="navi"><a href="LIB_Features_Mathematics_and_Statistics.html"><div class="navi">+ 5 Mathematics and Statistics </div></a></li>
<li class="navi"><a href="LIB_Features_string_functions.html"><div class="navi">+ 6 String Functions </div></a></li>
<li class="navi"><a href="LIB_Features_date_and_time_functions.html"><div class="navi">+ 7 Date and Time Functions </div></a></li>
<li class="navi"><a href="LIB_Features_parameter_set_functions.html"><div class="navi">+ 8 Parameter Set Functions </div></a></li>
<li class="navi"><a href="LIB_Features_table_functions.html"><div class="navi">9 Table Functions </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="LIB_Features_Loading_and_saving_tables.html"><div class="navi">+ 9.1 Loading and Saving Tables </div></a></li>
<li class="navi"><a href="LIB_Features_Console_I_O_with_tables.html"><div class="navi">+ 9.2 Console I/O with Tables </div></a></li>
<li class="navi"><a href="LIB_Features_Create___read___write___delete_tables.html"><div class="navi">+ 9.3 Creating, Writing, Reading, Deleting </div></a></li>
<li class="navi"><a href="LIB_Features_Accessing_table_information.html"><div class="navi">+ 9.4 Accessing Table Information </div></a></li>
<li class="navi"><a href="LIB_Features_Searching_and_exploring_tables.html"><div class="navi">+ 9.5 Searching and Exploring Tables </div></a></li>
<li class="navi"><a href="LIB_Features_Control_Flow_Functions_for_Tables.html"><div class="navi">+ 9.6 Control Flow Functions for Tables </div></a></li>
<li class="navi"><a href="LIB_Features_Processing_tables.html"><div class="navi">+ 9.7 Processing Tables </div></a></li>
<li class="navi"><a href="LIB_Features_Multi-table_integration.html"><div class="navi">+ 9.8 Multi-Table Integration </div></a></li>
<li class="navi"><a href="LIB_Features_Formatting_and_styling_tables.html"><div class="navi">9.9 Formatting and Styling Tables </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="LIB_Features_Defining_User_Specific_Colors.html"><div class="navi">+ 9.9.1 Defining User Specific Colors </div></a></li>
<li class="navi"><a href="LIB_Features_Formatting_the_Tables.html"><div class="navi">9.9.2 Styling Functions </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="LIB_Function_table_style_table.html"><div class="navi">9.9.2.1 table style table </div></a></li>
<li class="navi"><a href="LIB_Function_table_style_rows.html"><div class="navi">9.9.2.2 table style rows </div></a></li>
<li class="navi"><a href="LIB_Function_table_style_columns.html"><div class="navi">9.9.2.3 table style columns </div></a></li>
<li class="navi"><a href="LIB_Function_table_style_cells.html"><div class="navi">9.9.2.4 table style cells </div></a></li>
<li class="navi"><a href="LIB_Features_Generic_Formatting_Attributes.html"><div class="navi">9.9.2.5 Generic Formatting Attributes </div></a></li>
<li class="navi"><a href="LIB_Features_Formatting_Precedences.html"><div class="navi">9.9.2.6 Formatting Coverages and Precedences </div></a></li>
<li class="navi"><a href="LIB_Function_table_style_auto_width.html"><div class="navi navi-selected">9.9.2.7 table style auto width </div></a></li>
<li class="navi"><a href="LIB_Function_table_style_theme.html"><div class="navi">9.9.2.8 table style themes (beta) </div></a></li>
</ul></li>
<li class="navi"><a href="LIB_Features_Finishing_up_formatting.html"><div class="navi">+ 9.9.3 Finishing up formatting </div></a></li>
</ul></li>
</ul></li>
<li class="navi"><a href="LIB_Features_variables_functions.html"><div class="navi">+ 10 Variables Functions </div></a></li>
<li class="navi"><a href="LIB_Features_directory_and_file_system_functions.html"><div class="navi">+ 11 Directory and File System Functions </div></a></li>
<li class="navi"><a href="LIB_Features_system_functions.html"><div class="navi">+ 12 System Functions </div></a></li>
<li class="navi"><a href="LIB_Features_help_and_support_functions.html"><div class="navi">+ 13 Help and Support Functions </div></a></li>
<li class="navi"><a href="LIB_Features_Cross-functional_info.html"><div class="navi">+ 14 Cross-Functional Info </div></a></li>
<li class="navi"><div>  </div></li>
<li class="navi"><div>  </div></li>
<li class="navi"><div>  </div></li>
<li class="navi"><a href="GUI_Features_User_Guide.html"><div class="navi"> &#8594; User Guide </div></a></li>
<li class="navi"><a href="LAN_Features_Language_Guide.html"><div class="navi"> &#8594; Language Guide </div></a></li>
<li class="navi"><div>  </div></li>
<li class="navi"><a href="LIB_Features_Index.html"><div class="navi"> Index </div></a></li>
</ul>
	</div>

	<div class="article">
<h4> Function Names</h4>
<div class="white_background_color" ><code>table style auto width</code></div>
<h4> Library</h4>
<p>Style Library</p>
<h4> Description</h4>
<p>
This function will adjust the width the table columns automatically.  If only one function parameter, namely the table name, is provided, then
the column widths will be adjusted according to default settings and should be fine in most cases.  However, you can add one or more pairs of two
parameters which consist of <i>attribute names</i> and <i>attribute values</i> in order to refine the automatic width adjustment.  The attributes
are summarized in teh table below.

</p><table class="bold_column_1" style = "width:1000px"><col style = "width:200px"><col style = "width:200px"><col style = "width:600px">
<tr><th>Attribute Name  </th><th> Attribute Value   </th><th> Description</th></tr>
<tr><td>min     </td><td> Numeral: 1..255   </td><td> Defines the minimum column width. Non-integer values will be rounded up. <br>Default value: 4</td></tr>
<tr><td>max     </td><td> Numeral: 1..255   </td><td> Defines the maximum column width. Longer contents may either not be fully visible or do wrap. Non-integer values will be rounded up. <br>Default value: 255</td></tr>
<tr><td>factor        </td><td> Numeral: 0.1 - 20 </td><td> Scaling factor applied to estimate the width based on number of characters. <br>Default value: 1.2<br>                              With font size 10, one character typically takes a unit width of 1.  See further info underneath the table.</td></tr>
<tr><td>quantile  </td><td> Numeral: 0..1     </td><td> The quantile rules the percentage of rows ordered from shortest to longest to be included to estimate the width. <br> Example a: Quantile of 1.0 considers the widest contents checked. <br> Example b: Quantile of 0.5 considers the median width of all contents checked<br> Example c: Quantile of 0.9 considers 90% of the shorter contents and ignores the 10% longest contents in order to avoid providing too wide columns for a minority of long data.<br>                              Default value: 1</td></tr>
<tr><td>wrap text   </td><td> headers<br>table<br>body<br>none </td><td> Appliy text wrapping for headers, table (headers and and body), body (without headers) or none.  <br>Default value: headers.</td></tr>
<tr><td>starting row    </td><td> Numeral: row number   </td><td> Starting row number to assess contents for row width (use 0 to include header row).  Negative indexing is supported. <br>Default value: 0</td></tr>
<tr><td>stopping row  </td><td> Numeral: row number   </td><td> Stoping row number to assess contents for row width (use 0 for header row only).  You may consider checking the whole table, but  this may require significant amount of time for very large tables.  Therefore, a representative check of a smaller number of rows makes sense.                                Negative indexing is supported. <br>Default value: 50</td></tr>
<tr><td>starting column </td><td> Numeral: column number</td><td> Column width adjustment begins with this column.  Negative indexing is supported.  <br>Default value: 0 (first column)</td></tr>
<tr><td>stopping column </td><td> Numeral: column number</td><td> Column width adjustment ends with this column.  Negative indexing is supported.  <br>Default value: -1 (last column acc. to maximum table width)</td></tr>
</table><p>

Info on the attribute name <b>factor</b>: The width characteristics of the chosen font name, font type (monospace or not), font size and actual contents (e.g. mainly upper case text, or
words with more narrow typefaced letters(e.g. l) or wider typefaced letters (e.g. W) contribute to some inaccuracies.  A scaling factor of 1.0 may work fine for font size 10, but consider
a higher scaling factor to allow for more space for bigger text or generally more spece.  You can still apply lower and upper boundaries for the columns.

</p>
<h4> Call as: <span class="black_text">procedure</span></h4>
<h4> Restrictions</h4>
<p>Don't forget to include 'Style Library' at the top of your program</p>
<h4> Parameter count</h4>
<p>1, 3, 5, 7, etc.</p>
<h4> Parameters</h4>
<table class="simple"><col style = "width:80px"><col style = "width:120px"><col style = "width:800px"><tr><th>No.</th><th>Type</th><th>Description</th></tr>
<tr><td>1.<br/>input</td>
<td>string</td>
<td><b>Name fo existing table</b><br/><p></p>
</td></tr>
<tr><td>Opt. 2, 4, ...<br/>input</td>
<td>string</td>
<td><b>Auto width attribute name</b><br/><p>See table above for supported attribute names.</p>
</td></tr>
<tr><td>Opt. 3, 5, ...<br/>input</td>
<td>string</td>
<td><b>Auto width attribute value</b><br/><p>See table above for supported attribute values.</p>
</td></tr>
</table>
<h4> Examples</h4>
<div class="code_background_color" ><code>&nbsp;&nbsp;table load( t1, "Examples&#92;Cities.csv" );<br/>
&nbsp;&nbsp;table copy table( t1, t2 );<br/>
<br/>
&nbsp;&nbsp;// Simple example<br/>
<br/>
&nbsp;&nbsp;table style auto width ( t1 );<br/>
<br/>
&nbsp;&nbsp;// Example with customized paramters (narrowed intentionally).<br/>
<br/>
&nbsp;&nbsp;table style auto width ( t2, quantile, 0.9, wrap text, table, starting column, 0, stopping column, -3 );<br/>
&nbsp;&nbsp;table style auto width ( t2, min, 20, max, 30, starting column, -2 );<br/>
<br/>
<br/>
&nbsp;&nbsp;// Prepare and save the work<br/>
<br/>
&nbsp;&nbsp;table save excel file&nbsp;&nbsp;( { t1, t2 }, { Simple, Customized }, "Images/Style_Auto_Width.xlsx" );<br/>
<br/>
&nbsp;&nbsp;echo("Done.");</code></div>
<h4> Output</h4>
<div class="output_background_color" ><code>&nbsp;&nbsp;&nbsp;&nbsp;Saved table(s) to EXCEL file 'Images/Style_Auto_Width.xlsx' containing 2 sheets.<br><br>Done.<br></code></div><u>Try it yourself:</u> Open <b>LIB_Function_table_style_auto_width.b4p</b> in <a class="bold_text" href="B4P_Examples.zip">B4P_Examples.zip</a>. Decompress before use.
<h4> Viewing the Results:</h4>
<p>Test Click on the file name open the file with Excel (.xlsx) : <a href="Images/Style_Auto_Width.xlsx" >Style_Auto_Width.xlsx</a> (Excel .xlsx formats).</p>
	</div>
</section>

<div class="footer">
Copyright (C) 2007 - 2021 Georg zur Bonsen, All Rights Reserved
</div>

</div>

</html>	


