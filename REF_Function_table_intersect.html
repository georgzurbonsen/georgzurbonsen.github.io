<!DOCTYPE html>
<html lang="en-US">	

<head>
<meta charset="utf-8"/>
<title>B4P Reference</title>
<link rel="stylesheet" href="styles.css">
</head>


<div class="wrapper">

<div class="logo">
<a href="index.html">
<img src="Images/B4P_Logo.png" alt="Beyond4P">
</a>
</div>

<div class="header">
<h3>table intersect ...</h3>
<a accesskey="p" href="REF_Function_table_overlay.html"><span>Prev</span></a> <a accesskey="n" href="REF_Function_table_subtract.html"><span>Next</span></a> 
</div>

<section>
	<div class="nav">
<div class="booktitle_field">Reference Manual</div>
<ul>
<li class="navi"><a href="GUI_Features_Table_of_Contents.html"><div class="navi"> &#8594; User Guide </div></a></li>
<li class="navi"><a href="REF_Features_Table_of_Contents.html"><div class="navi"> Table of Contents </div></a></li>
<li class="navi"><a href="REF_Features_starting.html"><div class="navi">1 Starting B4P </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="REF_Features_interactive.html"><div class="navi">1.1 Interactive Mode </div></a></li>
<li class="navi"><a href="REF_Features_licensing.html"><div class="navi">1.2 Licensing </div></a></li>
</ul></li>
<li class="navi"><a href="REF_Features_introduction.html"><div class="navi">2 Introduction </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="REF_Features_UNICODE_character_set.html"><div class="navi">2.1 UNICODE Character Set </div></a></li>
<li class="navi"><a href="REF_Features_data_types.html"><div class="navi">2.2 Basic Data Types </div></a></li>
<li class="navi"><a href="REF_Features_variables.html"><div class="navi">2.3 Variables </div></a></li>
<li class="navi"><a href="REF_Features_comments.html"><div class="navi">2.4 Comments </div></a></li>
<li class="navi"><a href="REF_Features_reserved_keywords.html"><div class="navi">2.5 Reserved keywords </div></a></li>
<li class="navi"><a href="REF_Features_path_names.html"><div class="navi">2.6 Path and File Names </div></a></li>
<li class="navi"><a href="REF_Features_Locales.html"><div class="navi">2.7 Locales </div></a></li>
</ul></li>
<li class="navi"><a href="REF_Features_Functions_and_Procedures.html"><div class="navi">3 Functions and Procedures </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="REF_Features_Function_Parameters.html"><div class="navi">3.1 Function Parameters </div></a></li>
<li class="navi"><a href="REF_Features_Function_parameter_directions.html"><div class="navi">3.2 Function Parameter Directions </div></a></li>
<li class="navi"><a href="REF_Features_Function_parameter_types.html"><div class="navi">3.3 Function Parameter Types </div></a></li>
<li class="navi"><a href="REF_Features_Indirect_parameter_passing.html"><div class="navi">3.4 Indirect Parameter Passing </div></a></li>
</ul></li>
<li class="navi"><a href="REF_Features_Function_Library.html"><div class="navi">4 Function Library </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="REF_Features_Control_Flow_Functions.html"><div class="navi">4.1 Control Flow Functions </div></a></li>
<li class="navi"><a href="REF_Features_Type_Conversion_Functions.html"><div class="navi">4.2 Type Conversion and Formatting Functions </div></a></li>
<li class="navi"><a href="REF_Features_Mathematics_and_Statistics.html"><div class="navi">4.3 Mathematics and Statistics </div></a></li>
<li class="navi"><a href="REF_Features_string_functions.html"><div class="navi">4.4 String Functions </div></a></li>
<li class="navi"><a href="REF_Features_date_and_time_functions.html"><div class="navi">4.5 Date and Time Functions </div></a></li>
<li class="navi"><a href="REF_Features_parameter_set_functions.html"><div class="navi">4.6 Parameter Set Functions </div></a></li>
<li class="navi"><a href="REF_Features_table_functions.html"><div class="navi">4.7 Table Functions </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="REF_Features_table_creating_deleting.html"><div class="navi">4.7.1 Creating and Deleting Tables </div></a></li>
<li class="navi"><a href="REF_Features_accessing_table_info.html"><div class="navi">4.7.2 Accessing Table Information </div></a></li>
<li class="navi"><a href="REF_Features_Accessing_table_contents.html"><div class="navi">4.7.3 Accessing Table Contents </div></a></li>
<li class="navi"><a href="REF_Features_Loading_and_saving_tables.html"><div class="navi">4.7.4 Loading and Saving Tables </div></a></li>
<li class="navi"><a href="REF_Features_Checking_headers.html"><div class="navi">4.7.5 Checking and Processing Headers </div></a></li>
<li class="navi"><a href="REF_Features_Searching_tables.html"><div class="navi">4.7.6 Searching Tables </div></a></li>
<li class="navi"><a href="REF_Features_Processing_table_columns.html"><div class="navi">4.7.7 Processing Table Columns </div></a></li>
<li class="navi"><a href="REF_Features_Processing_table_rows.html"><div class="navi">4.7.8 Processing Table Rows </div></a></li>
<li class="navi"><a href="REF_Features_Processing_table_contents.html"><div class="navi">4.7.9 Processing Table Contents </div></a></li>
<li class="navi"><a href="REF_Features_Copying_and_spitting_tables.html"><div class="navi">4.7.10 Renaming, Copying and Splitting Tables </div></a></li>
<li class="navi"><a href="REF_Features_Checking_and_comparing_tables.html"><div class="navi">4.7.11 Checking and Comparing Tables </div></a></li>
<li class="navi"><a href="REF_Features_Looking_up_Other_Tables.html"><div class="navi">4.7.12 Looking up Other Tables </div></a></li>
<li class="navi"><a href="REF_Features_Pivoting_and_consolidating_tables.html"><div class="navi">4.7.13 Pivoting and Conosolidating Tables </div></a></li>
<li class="navi"><a href="REF_Features_Combining_Multiple_Tables.html"><div class="navi">4.7.14 Combining Multiple Tables </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="REF_Function_table_merge.html"><div class="navi">4.7.14.1 table merge ... </div></a></li>
<li class="navi"><a href="REF_Function_table_overlay.html"><div class="navi">4.7.14.2 table overlay/subtract ... </div></a></li>
<li class="navi"><a href="REF_Function_table_intersect.html"><div class="navi navi-selected">4.7.14.3 table intersect ... </div></a></li>
<li class="navi"><a href="REF_Function_table_subtract.html"><div class="navi">4.7.14.4 table subtract ... </div></a></li>
<li class="navi"><a href="REF_Function_table_exclude.html"><div class="navi">4.7.14.5 table exclude ... </div></a></li>
<li class="navi"><a href="REF_Function_table_multiply.html"><div class="navi">4.7.14.6 table multiply ... </div></a></li>
<li class="navi"><a href="REF_Function_table_divide.html"><div class="navi">4.7.14.7 table divide ... </div></a></li>
<li class="navi"><a href="REF_Function_table_arrange.html"><div class="navi">4.7.14.8 table arrange ... </div></a></li>
</ul></li>
</ul></li>
<li class="navi"><a href="REF_Features_directory_and_file_system.html"><div class="navi">+ 4.8 Directory and File System Functions </div></a></li>
<li class="navi"><a href="REF_Features_Cross-functional_info.html"><div class="navi">+ 4.9 Cross-Functional Info </div></a></li>
</ul></li>
<li class="navi"><a href="REF_Features_verbose.html"><div class="navi"> Verbose Levels </div></a></li>
</ul>
	</div>

	<div class="article">
<h4> Function Names</h4>
<div class="white_background_color" ><code>table intersect, table intersect extend columns, table intersect intersect columns, table intersect columns, table intersect exclusive columns</code></div>
<h4> Description</h4>
<p>
The functions described here intersect the contents of the source table into the destination table.  Identifier columns can be defined for both tables in order to
identify the overlapping table rows (e.g. same first and last names).

<br><br>

For the merging process, the principle of <i>intersection</i> is applied.  After the function call, the destination table will only contain those rows which
share the same data in the identifier columns in both source and destination tables, where the data in the rows from the source table has been consolidated into
the corresponding rows in the destination table using available <a class="bold_text" href="REF_Features_consolidation_actions.html">consolidation actions</a>.  The consolidation actions
work similarly like in the function <a class="bold_text" href="REF_Function_table_consolidate.html">table consolidate</a>() where exactly two rows are consolidated into one row.

<br><br>

In case the two tables contain multiple equal values in the identifier columns (for example if only the first name has been referred), then every affecting row in the
source table will be consolidated in one row in the destination table and then checked off as 'done'.  If another row in the source table has the same value, then
the next match further below in the destination table will be seeked.  If the source table contains more repeated contents in the identifier column than in the
destination table, then the remaining rows will be added to the end of the destination table.

<br><br>
The following functions use different approaches to combine the data columns:
</p><table class="noframe_1stcolbold" style = "width:1000px"><col style = "width:250px"><col style = "width:750px">
<tr><td>table intersect                     </td><td> No further columns are added to the destination table</td></tr>
<tr><td>table intersect extend columns      </td><td> Columns in the source table but not found in the destinationtable will be added to the target table (union set)</td></tr>
<tr><td>table intersect intersect columns   </td><td> Removes columns from the destination table if they do not exist in the source table (intersection)</td></tr>
<tr><td>table intersect subtract columns    </td><td> removes columns from destination table if they are found in the source table, but keeps the identifier columns.</td></tr>
<tr><td>table intersect exclusive columns   </td><td> Removes columns found in both source and destination table, but keeps the identifier columns (exclusive OR).</td></tr>
</table><p>

<br/><img src="Images/Function_table_intersect.jpg" alt="Function 'table intersect'"><br/><br/>

<u>Note</u>: If the destination table does not yet exist, or if the table is entirely empty (i.e. no header inside), then the data in the source table will be copied into the destination table.

Typical applications:
</p><ul class="bullets"><li class="bullets">Finding commonalities in mulitple tables</li>
<li class="bullets">Helful to identify the degree of standardization of items (e.g. re-use of components listed in bills of materials)</li>
</ul><p>
</p>
<h4> Call as: <span class="black_text">procedure or function</span></h4>
<h4> Restrictions</h4>
<p>Indirect parameter passing is disabled</p>
<h4> Parameter count</h4>
<p>2-6 (Max 3 for function names 'table intersect subtract/exclusive columns').  <br>See <a class="bold_text" href="REF_Function_table_merge.html">table merge</a>() for parameter and return value description</p>
<h4> Program Examples with 'table intersect ...'</h4>
<p></p>
<h5> Merging tables into one without identifier columns specified</h5>
<div class="code_background_color" ><code><br/>
 &nbsp; &nbsp; &nbsp;echo("Loading farms in Hillboro and Hillville");<br/>
 &nbsp; &nbsp; &nbsp;table load( hb, "Examples/Table Merge Examples Hillboro.csv");<br/>
 &nbsp; &nbsp; &nbsp;table load( hv, "Examples/Table Merge Examples Hillville.csv");<br/>
<br/>
 &nbsp; &nbsp; &nbsp;echo("Farms in Hillboro:");<br/>
 &nbsp; &nbsp; &nbsp;table list( hb );<br/>
<br/>
 &nbsp; &nbsp; &nbsp;echo("Farms in Hillville:");<br/>
 &nbsp; &nbsp; &nbsp;table list( hv );<br/>
<br/>
 &nbsp; &nbsp; &nbsp;count[] = table intersect( hv, hb );<br/>
<br/>
 &nbsp; &nbsp; &nbsp;echo("Hilltown is a merger of Hillboro and Hillville (", count[], " rows consolidated):");<br/>
 &nbsp; &nbsp; &nbsp;table list( hb );</code></div>
<h5> Output: Table will be empty because no identifier column is specified, so every column is unique</h5>
<div class="output_background_color" ><code>Loading farms in Hillboro and Hillville<br/>
Farms in Hillboro:<br/>
 &nbsp; &nbsp;0 : Organic | Place &nbsp; &nbsp;| Farmer &nbsp; &nbsp; | Wheat | Oat | Sheeps | Cows | Acres | Speciality<br/>
 &nbsp; &nbsp;1 : No &nbsp; &nbsp; &nbsp;| Hillboro | F. Fuller &nbsp;| 3 &nbsp; &nbsp; | &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp;| 4 &nbsp; &nbsp; | Hogs &nbsp; &nbsp; &nbsp;<br/>
 &nbsp; &nbsp;2 : Yes &nbsp; &nbsp; | Hillboro | R. Rudy &nbsp; &nbsp;| 19 &nbsp; &nbsp;| &nbsp; &nbsp; | 20 &nbsp; &nbsp; | 24 &nbsp; | 21 &nbsp; &nbsp;| Restaurant<br/>
 &nbsp; &nbsp;3 : &nbsp; &nbsp; &nbsp; &nbsp; | Hillboro | D. Daniels | 2 &nbsp; &nbsp; | &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp;| 3 &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br/>
 &nbsp; &nbsp;4 : No &nbsp; &nbsp; &nbsp;| Hillboro | M. Miller &nbsp;| 2 &nbsp; &nbsp; | 1 &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp;| 5 &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br/>
 &nbsp; &nbsp;5 : Yes &nbsp; &nbsp; | Hillboro | K. Klein &nbsp; | 10 &nbsp; &nbsp;| 10 &nbsp;| 40 &nbsp; &nbsp; | 30 &nbsp; | 28 &nbsp; &nbsp;| Vegetables<br/>
 &nbsp; &nbsp;6 : &nbsp; &nbsp; &nbsp; &nbsp; | Hillboro | P. Pomme &nbsp; | &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; | 50 &nbsp; &nbsp; | 40 &nbsp; | 21 &nbsp; &nbsp;| Apples &nbsp; &nbsp;<br/>
<br/>
Farms in Hillville:<br/>
 &nbsp; &nbsp;0 : Place &nbsp; &nbsp; | Farmer &nbsp; &nbsp; | Acres | Wheat | Barley | Corn | Cows | Organic | Speciality<br/>
 &nbsp; &nbsp;1 : Hillville | M. Miller &nbsp;| 20 &nbsp; &nbsp;| 4 &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp;| 5 &nbsp; &nbsp;| 30 &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; | Hops &nbsp; &nbsp; &nbsp;<br/>
 &nbsp; &nbsp;2 : Hillville | F. Fuller &nbsp;| 18 &nbsp; &nbsp;| 5 &nbsp; &nbsp; | 9 &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp;| 22 &nbsp; | Yes &nbsp; &nbsp; | Pigs &nbsp; &nbsp; &nbsp;<br/>
 &nbsp; &nbsp;3 : Hillville | B. Beaver &nbsp;| 23 &nbsp; &nbsp;| 1 &nbsp; &nbsp; | 4 &nbsp; &nbsp; &nbsp;| 3 &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp;| Yes &nbsp; &nbsp; | Sugar Pea <br/>
 &nbsp; &nbsp;4 : Hillville | J. Jill &nbsp; &nbsp;| 14 &nbsp; &nbsp;| 8 &nbsp; &nbsp; | 1 &nbsp; &nbsp; &nbsp;| 3 &nbsp; &nbsp;| 10 &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br/>
 &nbsp; &nbsp;5 : Hillville | D. Daniels | 21 &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp; | 18 &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp;| 0 &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp; &nbsp; | Lodging &nbsp; <br/>
<br/>
Hilltown is a merger of Hillboro and Hillville (0 rows consolidated):<br/>
 &nbsp; &nbsp;0 : Organic | Place | Farmer | Wheat | Oat | Sheeps | Cows | Acres | Speciality<br/>
<br/>
</code></div><br><u>Try it yourself:</u> Open <b>REF_Function_table_intersect00.b4p</b> in <a class="bold_text" href="B4P_Examples.zip">B4P_Examples.zip</a>. Decompress before use.
<h5> Declare 'Farmer' as unique identifier</h5>
<div class="code_background_color" ><code> &nbsp; &nbsp; &nbsp;table load( hb, "Examples/Table Merge Examples Hillboro.csv");<br/>
 &nbsp; &nbsp; &nbsp;table load( hv, "Examples/Table Merge Examples Hillville.csv");<br/>
<br/>
 &nbsp; &nbsp; &nbsp;count[] = table intersect( hv, hb, Farmer );<br/>
<br/>
 &nbsp; &nbsp; &nbsp;echo("Hilltown is a merger of Hillboro and Hillville (", count[], " rows consolidated):");<br/>
 &nbsp; &nbsp; &nbsp;table list( hb );</code></div>
<h5> Output: 3 farmers with land in both towns have been consolidated.</h5>
<div class="output_background_color" ><code>Hilltown is a merger of Hillboro and Hillville (6 rows consolidated):<br/>
 &nbsp; &nbsp;0 : Organic | Place &nbsp; &nbsp;| Farmer &nbsp; &nbsp; | Wheat | Oat | Sheeps | Cows | Acres | Speciality<br/>
 &nbsp; &nbsp;1 : No &nbsp; &nbsp; &nbsp;| Hillboro | F. Fuller &nbsp;| 3 &nbsp; &nbsp; | &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp;| 4 &nbsp; &nbsp; | Hogs &nbsp; &nbsp; &nbsp;<br/>
 &nbsp; &nbsp;2 : &nbsp; &nbsp; &nbsp; &nbsp; | Hillboro | D. Daniels | 2 &nbsp; &nbsp; | &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp;| 3 &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br/>
 &nbsp; &nbsp;3 : No &nbsp; &nbsp; &nbsp;| Hillboro | M. Miller &nbsp;| 2 &nbsp; &nbsp; | 1 &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp;| 5 &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br/>
<br/>
</code></div><br><u>Try it yourself:</u> Open <b>REF_Function_table_intersect01.b4p</b> in <a class="bold_text" href="B4P_Examples.zip">B4P_Examples.zip</a>. Decompress before use.
<h5> Merge data in smart way and add 2 columns from source table:</h5>
<div class="code_background_color" ><code> &nbsp; &nbsp; &nbsp;table load( hb, "Examples/Table Merge Examples Hillboro.csv");<br/>
 &nbsp; &nbsp; &nbsp;table load( hv, "Examples/Table Merge Examples Hillville.csv");<br/>
<br/>
 &nbsp; &nbsp; &nbsp;count[] = table intersect extend columns( hv, hb, Farmer, '*', { must match, append, 5:sum, append }, ", " );<br/>
 &nbsp; &nbsp; &nbsp;// '*' corresponds to {Organic, Place, Wheat, Oat, Sheeps, Cows, Acres, Speciality}<br/>
<br/>
 &nbsp; &nbsp; &nbsp;echo("Hilltown is a merger of Hillboro and Hillville (", count[], " rows consolidated):");<br/>
 &nbsp; &nbsp; &nbsp;table list( hb );</code></div>
<h5> Output: 3 farmers with land in both towns have been consolidated.</h5>
<div class="output_background_color" ><code>Hilltown is a merger of Hillboro and Hillville (6 rows consolidated):<br/>
 &nbsp; &nbsp;0 : Organic &nbsp; &nbsp; &nbsp; &nbsp; | Place &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | Farmer &nbsp; &nbsp; | Wheat | Oat | Sheeps | Cows | Acres | Speciality | Barley | Corn<br/>
 &nbsp; &nbsp;1 : (Inconsistent!) | Hillboro, Hillville | F. Fuller &nbsp;| 8 &nbsp; &nbsp; | &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp;| 22 &nbsp; | 22 &nbsp; &nbsp;| Hogs, Pigs | 9 &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; <br/>
 &nbsp; &nbsp;2 : &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | Hillboro, Hillville | D. Daniels | 2 &nbsp; &nbsp; | &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp;| 0 &nbsp; &nbsp;| 24 &nbsp; &nbsp;| Lodging &nbsp; &nbsp;| 18 &nbsp; &nbsp; | &nbsp; &nbsp; <br/>
 &nbsp; &nbsp;3 : No &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| Hillboro, Hillville | M. Miller &nbsp;| 6 &nbsp; &nbsp; | 1 &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp;| 30 &nbsp; | 25 &nbsp; &nbsp;| Hops &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp;| 5 &nbsp; <br/>
<br/>
</code></div><br><u>Try it yourself:</u> Open <b>REF_Function_table_intersect02.b4p</b> in <a class="bold_text" href="B4P_Examples.zip">B4P_Examples.zip</a>. Decompress before use.
<h5> Merge data in smart way and keep intersected columns:</h5>
<div class="code_background_color" ><code> &nbsp; &nbsp; &nbsp;table load( hb, "Examples/Table Merge Examples Hillboro.csv");<br/>
 &nbsp; &nbsp; &nbsp;table load( hv, "Examples/Table Merge Examples Hillville.csv");<br/>
<br/>
 &nbsp; &nbsp; &nbsp;count[] = table intersect intersect columns( hv, hb, Farmer, '*', { must match, append, 3:sum, append }, ", " );<br/>
 &nbsp; &nbsp; &nbsp;// '*' corresponds to {Organic, Place, Wheat, Cows, Acres, Speciality}<br/>
<br/>
 &nbsp; &nbsp; &nbsp;echo("Hilltown is a merger of Hillboro and Hillville (", count[], " rows consolidated):");<br/>
 &nbsp; &nbsp; &nbsp;table list( hb );</code></div>
<h5> Output: 3 farmers with land in both towns have been consolidated.</h5>
<div class="output_background_color" ><code>Hilltown is a merger of Hillboro and Hillville (6 rows consolidated):<br/>
 &nbsp; &nbsp;0 : Organic &nbsp; &nbsp; &nbsp; &nbsp; | Place &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | Farmer &nbsp; &nbsp; | Wheat | Cows | Acres | Speciality<br/>
 &nbsp; &nbsp;1 : (Inconsistent!) | Hillboro, Hillville | F. Fuller &nbsp;| 8 &nbsp; &nbsp; | 22 &nbsp; | 22 &nbsp; &nbsp;| Hogs, Pigs<br/>
 &nbsp; &nbsp;2 : &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | Hillboro, Hillville | D. Daniels | 2 &nbsp; &nbsp; | 0 &nbsp; &nbsp;| 24 &nbsp; &nbsp;| Lodging &nbsp; <br/>
 &nbsp; &nbsp;3 : No &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| Hillboro, Hillville | M. Miller &nbsp;| 6 &nbsp; &nbsp; | 30 &nbsp; | 25 &nbsp; &nbsp;| Hops &nbsp; &nbsp; &nbsp;<br/>
<br/>
</code></div><br><u>Try it yourself:</u> Open <b>REF_Function_table_intersect03.b4p</b> in <a class="bold_text" href="B4P_Examples.zip">B4P_Examples.zip</a>. Decompress before use.
<h5> Merge data in smart way and subtract the columns:</h5>
<div class="code_background_color" ><code> &nbsp; &nbsp; &nbsp;table load( hb, "Examples/Table Merge Examples Hillboro.csv");<br/>
 &nbsp; &nbsp; &nbsp;table load( hv, "Examples/Table Merge Examples Hillville.csv");<br/>
<br/>
 &nbsp; &nbsp; &nbsp;count[] = table intersect subtract columns( hv, hb, Farmer );<br/>
<br/>
 &nbsp; &nbsp; &nbsp;echo("Hilltown is a merger of Hillboro and Hillville (", count[], " rows consolidated):");<br/>
 &nbsp; &nbsp; &nbsp;table list( hb );</code></div>
<h5> Output: 3 farmers with land in both towns have been consolidated.</h5>
<div class="output_background_color" ><code>Hilltown is a merger of Hillboro and Hillville (0 rows consolidated):<br/>
 &nbsp; &nbsp;0 : Farmer &nbsp; &nbsp; | Oat | Sheeps<br/>
 &nbsp; &nbsp;1 : F. Fuller &nbsp;| &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; <br/>
 &nbsp; &nbsp;2 : D. Daniels | &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; <br/>
 &nbsp; &nbsp;3 : M. Miller &nbsp;| 1 &nbsp; | &nbsp; &nbsp; &nbsp; <br/>
<br/>
</code></div><br><u>Try it yourself:</u> Open <b>REF_Function_table_intersect04.b4p</b> in <a class="bold_text" href="B4P_Examples.zip">B4P_Examples.zip</a>. Decompress before use.
<h5> Merge data in smart way and show all columns except comomon ones:</h5>
<div class="code_background_color" ><code> &nbsp; &nbsp; &nbsp;table load( hb, "Examples/Table Merge Examples Hillboro.csv");<br/>
 &nbsp; &nbsp; &nbsp;table load( hv, "Examples/Table Merge Examples Hillville.csv");<br/>
<br/>
 &nbsp; &nbsp; &nbsp;count[] = table intersect exclusive columns( hv, hb, Farmer );<br/>
<br/>
 &nbsp; &nbsp; &nbsp;echo("Hilltown is a merger of Hillboro and Hillville (", count[], " rows consolidated):");<br/>
 &nbsp; &nbsp; &nbsp;table list( hb );</code></div>
<h5> Output: 3 farmers with land in both towns have been consolidated.</h5>
<div class="output_background_color" ><code>Hilltown is a merger of Hillboro and Hillville (6 rows consolidated):<br/>
 &nbsp; &nbsp;0 : Farmer &nbsp; &nbsp; | Oat | Sheeps | Barley | Corn<br/>
 &nbsp; &nbsp;1 : F. Fuller &nbsp;| &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp;| 9 &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; <br/>
 &nbsp; &nbsp;2 : D. Daniels | &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp;| 18 &nbsp; &nbsp; | &nbsp; &nbsp; <br/>
 &nbsp; &nbsp;3 : M. Miller &nbsp;| 1 &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp; &nbsp;| 5 &nbsp; <br/>
<br/>
</code></div><br><u>Try it yourself:</u> Open <b>REF_Function_table_intersect05.b4p</b> in <a class="bold_text" href="B4P_Examples.zip">B4P_Examples.zip</a>. Decompress before use.
<h4> Tables with multiple non-unique identifiers being merged:</h4>
<p>In case you plan to merge two tables with a one or a selection of column identifiers which cannot guarantee uniqueness,
e.g. a list of names identified by first name only, then this function will match first name pairs first,
then the next ones below, and so forth.  As a result, every row is considered only once.  Long story short:
Every row in the destination table will be consolidated only once.
The following code example demonstrates this:</p>
<h5> One Jill and tow Micheles will be consolidated:</h5>
<div class="code_background_color" ><code><br/>
 &nbsp; &nbsp; &nbsp;table load( h1, "Examples/Table Merge Examples Hobbies 1.csv");<br/>
 &nbsp; &nbsp; &nbsp;table load( h2, "Examples/Table Merge Examples Hobbies 2.csv");<br/>
<br/>
 &nbsp; &nbsp; &nbsp;echo("Hoobies 1:"); &nbsp; &nbsp; &nbsp;table list( h1 );<br/>
 &nbsp; &nbsp; &nbsp;echo("Hoobies 2:"); &nbsp; &nbsp; &nbsp;table list( h2 );<br/>
<br/>
 &nbsp; &nbsp; &nbsp;count[] = table intersect( h2, h1, Name, '*', append, ', ' );<br/>
<br/>
 &nbsp; &nbsp; &nbsp;echo("Combined list of hobbies (", count[], " rows consolidated):");<br/>
 &nbsp; &nbsp; &nbsp;table list( h1 );</code></div>
<h5> The outcome</h5>
<div class="output_background_color" ><code>Hoobies 1:<br/>
 &nbsp; &nbsp;0 : Name &nbsp; &nbsp;| Hobby &nbsp; | Sport &nbsp; &nbsp; | Color &nbsp; &nbsp;| Animal<br/>
 &nbsp; &nbsp;1 : Jill &nbsp; &nbsp;| Games &nbsp; | Snowboard | Gray &nbsp; &nbsp; | Dog &nbsp; <br/>
 &nbsp; &nbsp;2 : Michele | Games &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | Pink &nbsp; &nbsp; | Cat &nbsp; <br/>
 &nbsp; &nbsp;3 : Michele | Reading | Riding &nbsp; &nbsp;| Red &nbsp; &nbsp; &nbsp;| Horse <br/>
 &nbsp; &nbsp;4 : Jill &nbsp; &nbsp;| Theatre | Sailing &nbsp; | Turquois | Whale <br/>
<br/>
Hoobies 2:<br/>
 &nbsp; &nbsp;0 : Name &nbsp; &nbsp;| Hobby &nbsp; &nbsp; &nbsp; | Sport &nbsp; &nbsp;| Color &nbsp; | Animal<br/>
 &nbsp; &nbsp;1 : Michele | Playing &nbsp; &nbsp; | Golf &nbsp; &nbsp; | Brown &nbsp; | Tiger <br/>
 &nbsp; &nbsp;2 : Michele | Writing &nbsp; &nbsp; | Riding &nbsp; | Magenta | Pony &nbsp;<br/>
 &nbsp; &nbsp;3 : Michele | Photography | Soccer &nbsp; | Blue &nbsp; &nbsp;| Fish &nbsp;<br/>
 &nbsp; &nbsp;4 : Michele | Movies &nbsp; &nbsp; &nbsp;| Handball | Green &nbsp; | Crabs <br/>
 &nbsp; &nbsp;5 : Jill &nbsp; &nbsp;| Drama &nbsp; &nbsp; &nbsp; | Surfing &nbsp;| Skyblue | Trouts<br/>
<br/>
Combined list of hobbies (4 rows consolidated):<br/>
 &nbsp; &nbsp;0 : Name &nbsp; &nbsp;| Hobby &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| Sport &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| Color &nbsp; &nbsp; &nbsp; &nbsp; | Animal &nbsp; &nbsp; <br/>
 &nbsp; &nbsp;1 : Jill &nbsp; &nbsp;| Games, Drama &nbsp; &nbsp; | Snowboard, Surfing | Gray, Skyblue | Dog, Trouts<br/>
 &nbsp; &nbsp;2 : Michele | Games, Playing &nbsp; | Golf &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | Pink, Brown &nbsp; | Cat, Tiger <br/>
 &nbsp; &nbsp;3 : Michele | Reading, Writing | Riding, Riding &nbsp; &nbsp; | Red, Magenta &nbsp;| Horse, Pony<br/>
<br/>
</code></div><br><u>Try it yourself:</u> Open <b>REF_Function_table_intersect06.b4p</b> in <a class="bold_text" href="B4P_Examples.zip">B4P_Examples.zip</a>. Decompress before use.
<h4> See also</h4>
<p><a class = "bold_text" href="REF_Function_table_merge.html">table merge</a><br/>
<a class = "bold_text" href="REF_Function_table_overlay.html">table overlay</a><br/>
<a class = "bold_text" href="REF_Function_table_subtract.html">table subtract</a><br/>
<a class = "bold_text" href="REF_Function_table_exclude.html">table exclude</a><br/>
<a class = "bold_text" href="REF_Function_table_consolidate.html">table consolidate</a></p>
	</div>
</section>

<div class="footer">
Copyright (C) 2007 - 2020 Georg zur Bonsen
</div>

</div>

</html>	


