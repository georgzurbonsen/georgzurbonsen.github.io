<!DOCTYPE html>
<html lang="en-US">	

<head>
<meta charset="utf-8"/>
<title>B4P Reference</title>
<link rel="stylesheet" href="styles.css">
</head>


<div class="wrapper">

<div class="logo">
<a href="index.html">
<img src="Images/B4P_Logo.png" alt="B4P">
</a>
</div>

<div class="header">
<h3>table load ...</h3>
<a accesskey="p" href="LIB_Features_Loading_and_saving_tables.html"><span>Prev</span></a> <a accesskey="n" href="LIB_Features_Loading_HTML_files.html"><span>Next</span></a> 
</div>

<section>
	<div class="nav">
<div class="booktitle_field">Function Library Guide</div>
<ul>
<li class="navi"><a href="GUI_Features_overview.html"><div class="navi"> &#8594; User Guide </div></a></li>
<li class="navi"><a href="LAN_Features_Introduction.html"><div class="navi"> &#8594; Language Guide </div></a></li>
<li class="navi"><a href="LIB_Features_Table_of_Contents.html"><div class="navi"> Table of Contents </div></a></li>
<li class="navi"><a href="LIB_Features_Function_Library.html"><div class="navi">1 Function Library </div></a></li>
<li class="navi"><a href="LIB_Features_Control_flow_functions.html"><div class="navi">+ 2 Control Flow Functions </div></a></li>
<li class="navi"><a href="LIB_Features_Console_I_O_Functions.html"><div class="navi">+ 3 Console I/O Functions </div></a></li>
<li class="navi"><a href="LIB_Features_Type_Conversion_Functions.html"><div class="navi">+ 4 Type Conversion and Formatting </div></a></li>
<li class="navi"><a href="LIB_Features_Mathematics_and_Statistics.html"><div class="navi">+ 5 Mathematics and Statistics </div></a></li>
<li class="navi"><a href="LIB_Features_string_functions.html"><div class="navi">+ 6 String Functions </div></a></li>
<li class="navi"><a href="LIB_Features_date_and_time_functions.html"><div class="navi">+ 7 Date and Time Functions </div></a></li>
<li class="navi"><a href="LIB_Features_parameter_set_functions.html"><div class="navi">+ 8 Parameter Set Functions </div></a></li>
<li class="navi"><a href="LIB_Features_table_functions.html"><div class="navi">9 Table Functions </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="LIB_Features_Loading_and_saving_tables.html"><div class="navi">9.1 Loading and Saving Tables </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="LIB_Function_table_load.html"><div class="navi navi-selected">9.1.1 table load ... </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="LIB_Features_Loading_HTML_files.html"><div class="navi">9.1.1.1 Loading HTML files </div></a></li>
<li class="navi"><a href="LIB_Features_Loading_XML_files.html"><div class="navi">9.1.1.2 Loading XML files </div></a></li>
<li class="navi"><a href="LIB_Features_Loading_JSON_files.html"><div class="navi">9.1.1.3 Loading JSON files </div></a></li>
</ul></li>
<li class="navi"><a href="LIB_Function_table_save.html"><div class="navi">+ 9.1.2 table save ... </div></a></li>
<li class="navi"><a href="LIB_Function_excel_list_sheets.html"><div class="navi">9.1.3 excel list sheets </div></a></li>
<li class="navi"><a href="LIB_Function_table_load_excel_file.html"><div class="navi">9.1.4 table load excel file </div></a></li>
<li class="navi"><a href="LIB_Function_table_save_excel_file.html"><div class="navi">9.1.5 table save excel file </div></a></li>
</ul></li>
<li class="navi"><a href="LIB_Features_Console_I_O_with_tables.html"><div class="navi">+ 9.2 Console I/O with Tables </div></a></li>
<li class="navi"><a href="LIB_Features_Create___read___write___delete_tables.html"><div class="navi">+ 9.3 Creating, Writing, Reading, Deleting </div></a></li>
<li class="navi"><a href="LIB_Features_Accessing_table_information.html"><div class="navi">+ 9.4 Accessing Table Information </div></a></li>
<li class="navi"><a href="LIB_Features_Searching_and_exploring_tables.html"><div class="navi">+ 9.5 Searching and Exploring Tables </div></a></li>
<li class="navi"><a href="LIB_Features_Control_Flow_Functions_for_Tables.html"><div class="navi">+ 9.6 Control Flow Functions for Tables </div></a></li>
<li class="navi"><a href="LIB_Features_Processing_tables.html"><div class="navi">+ 9.7 Processing Tables </div></a></li>
<li class="navi"><a href="LIB_Features_Multi-table_integration.html"><div class="navi">+ 9.8 Multi-Table Integration </div></a></li>
<li class="navi"><a href="LIB_Features_Formatting_and_styling_tables.html"><div class="navi">+ 9.9 Formatting and Styling Tables </div></a></li>
</ul></li>
<li class="navi"><a href="LIB_Features_variables_functions.html"><div class="navi">+ 10 Variables Functions </div></a></li>
<li class="navi"><a href="LIB_Features_directory_and_file_system_functions.html"><div class="navi">+ 11 Directory and File System Functions </div></a></li>
<li class="navi"><a href="LIB_Features_system_functions.html"><div class="navi">+ 12 System Functions </div></a></li>
<li class="navi"><a href="LIB_Features_help_and_support_functions.html"><div class="navi">+ 13 Help and Support Functions </div></a></li>
<li class="navi"><a href="LIB_Features_Cross-functional_info.html"><div class="navi">+ 14 Cross-Functional Info </div></a></li>
<li class="navi"><a href="LIB_Features_Index.html"><div class="navi">15 Index </div></a></li>
<li class="navi"><a href="LIB_Function_dump_functions.html"><div class="navi"> dump functions </div></a></li>
<li class="navi"><a href="LIB_Function_list_functions.html"><div class="navi"> list / explain functions </div></a></li>
</ul>
	</div>

	<div class="article">
<h4> Function Names</h4>
<div class="white_background_color" ><code>table load, table load unchanged</code></div>
<h4> Description</h4>
<p>
This function loads a table from a file.  Following file formats are supported:

</p><table class="bold_column_1" style = "width:1000px"><col style = "width:100px"><col style = "width:200px"><col style = "width:700px">
<tr><td>CSV             </td><td> Comma separated files     </td><td> Files separated with a specified symbol, typically a comma, semicolon or tab</td></tr>
<tr><td>TEXT            </td><td> Text file                 </td><td> Loads text files into a table consisting of 1 column. Every column contains one line of text.</td></tr>
<tr><td>HTML            </td><td> HTML file                 </td><td> Loads a specifically selected table from the HTML file</td></tr>
<tr><td>XML             </td><td> XML (extended markup) file</td><td> Loads a complete XML file into a sequential table</td></tr>
<tr><td>JSON            </td><td> JavaScript Object Notation format </td><td> Loads a complete JSON file into a sequential table</td></tr>
<tr><td>JSON TABLE      </td><td> JavaScript Object Notation format </td><td> Loads a specifically selected JSON table (which is a 2-dimensional array) into a table</td></tr>
</table><p>

For CSV file formats, the function <b>table load</b> will automatically convert numbers with decimal commas (e.g. 123,456) to numbers with decimal points (123.456)
so they can be processed further and conveniently.  This feature is particularly useful with processing data originating from databases or Excel with settings
specific to Germany and some other countries which use decimal commas.  If this automatic conversion is not desired because the table data entries with numbers separated
with a comma but seen as actual numbers but possibly a set of two digits, then use the function <b>table load unchanged</b> instead.   In this case, value like 123,456 remain unchanged.
Various database systems, including SAP, Oracle, Salesforce which support exports as "Excel" files are in fact HTML or MHTML file formats.

<br><br>
A different and dedicated function called <a class="bold_text" href="LIB_Function_table_load_excel_file.html">table load excel file</a>() is available to load contemporary Excel files with the endings .xlsx, and .xlsm.  Prerequisite: File is not encrypted.

<br><br>
<b>Recognizing character formats</b>: B4P tries to automatically identify whether the file is ANSI (ASCII), Win 1252, iso8859-1, and UNICOD: UTF-8, UTF-16 or UTF-16 Big Endian.  The identification
is done by preambles in HTML, byte order marks, usage of non-ANSI characters and typical patterns in UTF-16 formats.

</p>
<h4> Call as: <span class="black_text">procedure or function</span></h4>
<h4> Restrictions</h4>
<p>Indirect parameter passing is disabled<br/>
context for partial table specification is required</p>
<h4> Parameter count</h4>
<p>2-4</p>
<h4> Parameters</h4>
<table class="simple"><col style = "width:80px"><col style = "width:120px"><col style = "width:800px"><tr><th>No.</th><th>Type</th><th>Description</th></tr>
<tr><td>1<br/>input</td>
<td>literal</td>
<td><b>Name of table</b><br/><p>If the table is existing, then it will be initialized first.</p>
</td></tr>
<tr><td>2<br/>input</td>
<td>literal</td>
<td><b>File name</b><br/><p>Specify the file name.  Add the path in front if the file is not located in the current working directory.</p>
</td></tr>
<tr><td>Opt. 3<br/>input</td>
<td>literal</td>
<td><b>File format descriptor</b><br/><p></p><table class="bold_column_1" style = "width:750px"><col style = "width:150px"><col style = "width:600px">
<tr><th>Value       </th><th> Description</th></tr>
<tr><td>,           </td><td> CSV with comma as separator. (Put it into quotation marks ',' when specifying it in the function parameter)</td></tr>
<tr><td>;           </td><td> CSV with semicolon as separator. (Put it into quotation marks ';' when specifying it in the function parameter)</td></tr>
<tr><td>?           </td><td> CSV with automatic detection of either comma, semicolon or tab.  The first occurence of these symbols will be used as separators. (Put it into quotation marks '?' when specifying it in the function parameter)</td></tr>
<tr><td>tab         </td><td> TSV using tab as separator (Do not use quotation marks here because tab is a reserved B4P keyword representing a single tab character)</td></tr>
<tr><td>CSV         </td><td> Same functionaliy as '?' with automatic dection of separator symbol</td></tr>
<tr><td>1 character </td><td> CSV with any other single character, e.g. "/" as separator</td></tr>
<tr><td>TEXT        </td><td> Text file.  The resulting table contains only one column where the column in every row contains the whole line of text.</td></tr>
<tr><td>HTML        </td><td> Loads HTML file.  See section on <a class="bold_text" href="LIB_Features_Loading_HTML_files.html">loading HTML files</a>.</td></tr>
<tr><td>MHTML       </td><td> Loads HTML file.  See section on <a class="bold_text" href="LIB_Features_Loading_HTML_files.html">loading HTML files</a>. (Same functionality for time being)</td></tr>
<tr><td>XML         </td><td> Loads XML file.  See section on <a class="bold_text" href="LIB_Features_Loading_XML_files.html">loading XML files</a>.</td></tr>
<tr><td>JSON        </td><td> Loads entire JSON file.  See section on <a class="bold_text" href="LIB_Features_Loading_JSON_files.html">loading JSON files</a>.</td></tr>
<tr><td>JSON TABLE  </td><td> Loads a specific table (coded as an array) from the JSON file.  See section on <a class="bold_text" href="LIB_Features_Loading_JSON_files.html">loading JSON files</a>.</td></tr>
</table><p>
</p>
<span class="black_text"><b> Default value: </b></span>CSV or ?
</td></tr>
<tr><td>Opt. 4<br/>input</td>
<td>parameter set</td>
<td><b>XML attributes to keep</b><br/><p>Applicable to file format descriptor <b>XML</b> only:<br>
Applicable for file format descriptor XML only: Specify the attributes in XML tags to keep.  The remaining ones will not be loaded.
This feature is particularly useful for very large XML files.</p>
<span class="black_text"><b> Default value: </b></span>(Keep all attributes)
</td></tr>
<tr><td>Alt. Opt. 4<br/>input</td>
<td>literal</td>
<td><b>Text pattern</b><br/><p>Applicable to file format descriptors <b>HTML, MJTML, JSON TABLE</b> only:<br>

Specify a text sequence, e.g. JSON elements, HTML elements, etc. which will be checked against the JSON and HTML text.
This feature is insofar useful when the HTML and JSON files contain multiple tables and a table other than the 1st table should be loaded.
In this case, find a unique text, e.g. a section name or distinct contents which appears before the table to load, but after the previous tables in the same file.

<br><br>
<u>Attention:</u> Wildcards are supported for JSON, but not for HTML and MHTML. Example: <b>' "name" : "C*" '</b>  looks for
"name" followed by ":" and followed by "C..." (beginning with "C").

<br><br>
<u>Advice:</u> Put the whole string in single quotation marks beacuse JSON and HTML syntax rules require text contents to be specified in double quotation marks, e.g. <b>'id="NASDAQ_Table"'</b>.

<br><br>
<u>Advice:</u> Some HTML links contain a pound symbol, e.g. "en.wikipedia.org/wiki/List_of_Roman_emperors#The_Principate".  To access the HTML table below this identifier "The_Principate"
which is, typical to Wikipedia, the section header "The Principate", download the entier HTML file and specify <b>'id="The_Principate"'</b> in this parameter to find next table located below.</p>
<span class="black_text"><b> Default value: </b></span>(look for 1st table)
</td></tr>
</table>
<h4> Return value</h4>
<table class="simple"><col style = "width:120px"><col style = "width:880px"><tr><th>Type</th><th>Description</th></tr>
<tr>
<td>boolean</td>
<td><b>Table has contents</b><br/><p>true if contents have been loaded, false if nothing has been loaded. In this case, the table is empty.</p></td></tr>
</table>
<h4> Exceptions</h4>
<p>File not found<br/>
File not accessible<br/>
File locked<br/>
Syntax errors in table formats, e.g in HTML, JSON, XML<br/>
File locked. Close the file in the other application and retry</p>
<h4> Examples</h4>
<div class="code_background_color" ><code>&nbsp;&nbsp;runtime&nbsp;settings[verbose]= quiet; // Supress blabla<br/>
<br/>
&nbsp;&nbsp;echo("Load&nbsp;the Cities file:");<br/>
&nbsp;&nbsp;table&nbsp;load( cities, "Examples&#92;Cities.csv" );<br/>
&nbsp;&nbsp;echo("Cities:&nbsp;", join( [cities:City,..], ", " ) );<br/>
</code></div>
<h4> Output</h4>
<div class="output_background_color" ><code>Load&nbsp;the&nbsp;Cities&nbsp;file:<br/>
Cities:&nbsp;New&nbsp;York&nbsp;City,&nbsp;Washington,&nbsp;Philadelphia,&nbsp;Boston,&nbsp;San&nbsp;Francisco,&nbsp;Montréal,&nbsp;Copenhagen,&nbsp;Venice,&nbsp;Los&nbsp;Angeles,&nbsp;Vienna,&nbsp;Bangkok,&nbsp;Zürich,&nbsp;Paris,&nbsp;Davos<br/>
</code></div><u>Try it yourself:</u> Open <b>LIB_Function_table_load.b4p</b> in <a class="bold_text" href="B4P_Examples.zip">B4P_Examples.zip</a>. Decompress before use.
<h4> See also</h4>
<p><a class = "bold_text" href="LIB_Function_table_save.html">table save</a><br/>
<a class = "bold_text" href="LIB_Function_table_load_excel_file.html">table load excel file</a><br/>
<a class = "bold_text" href="LIB_Features_Loading_XML_files.html">loading XML files</a><br/>
<a class = "bold_text" href="LIB_Features_Loading_JSON_files.html">loading JSON files</a></p>
	</div>
</section>

<div class="footer">
Copyright (C) 2007 - 2020 Georg zur Bonsen, All Rights Reserved
</div>

</div>

</html>	


