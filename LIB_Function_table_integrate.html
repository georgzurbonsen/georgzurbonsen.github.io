<!DOCTYPE html>
<html lang="en-US">	

<head>
<meta charset="utf-8"/>
<title>B4P Reference</title>
<link rel="stylesheet" href="styles.css">
</head>


<div class="wrapper">

<div class="logo">
<a href="index.html">
<img src="Images/B4P_Logo.png" alt="B4P">
</a>
</div>

<div class="header">
<h3>table integrate ...</h3>
<a accesskey="p" href="LIB_Function_table_lookup_smart_once.html"><span>Prev</span></a> <a accesskey="n" href="LIB_Function_table_integrate_once.html"><span>Next</span></a> 
</div>

<section>
	<div class="nav">
<div class="booktitle_field">Function Library Guide</div>
<ul>
<li class="navi"><a href="GUI_Features_overview.html"><div class="navi"> &#8594; User Guide </div></a></li>
<li class="navi"><a href="LAN_Features_Introduction.html"><div class="navi"> &#8594; Language Guide </div></a></li>
<li class="navi"><a href="LIB_Features_Table_of_Contents.html"><div class="navi"> Table of Contents </div></a></li>
<li class="navi"><a href="LIB_Features_Function_Library.html"><div class="navi">1 Function Library </div></a></li>
<li class="navi"><a href="LIB_Features_Control_Flow_Functions.html"><div class="navi">+ 2 Control Flow Functions </div></a></li>
<li class="navi"><a href="LIB_Features_Console_I_O_Functions.html"><div class="navi">+ 3 Console I/O Functions </div></a></li>
<li class="navi"><a href="LIB_Features_Type_Conversion_Functions.html"><div class="navi">+ 4 Type Conversion and Formatting </div></a></li>
<li class="navi"><a href="LIB_Features_Mathematics_and_Statistics.html"><div class="navi">+ 5 Mathematics and Statistics </div></a></li>
<li class="navi"><a href="LIB_Features_string_functions.html"><div class="navi">+ 6 String Functions </div></a></li>
<li class="navi"><a href="LIB_Features_date_and_time_functions.html"><div class="navi">+ 7 Date and Time Functions </div></a></li>
<li class="navi"><a href="LIB_Features_parameter_set_functions.html"><div class="navi">+ 8 Parameter Set Functions </div></a></li>
<li class="navi"><a href="LIB_Features_table_functions.html"><div class="navi">9 Table Functions </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="LIB_Features_table_functions_I_O_and_Access.html"><div class="navi">+ 9.1 Table I/O and Access </div></a></li>
<li class="navi"><a href="LIB_Features_table_functions_processing.html"><div class="navi">+ 9.2 Search and Processing </div></a></li>
<li class="navi"><a href="LIB_Features_Multi-table_integration.html"><div class="navi">9.3 Multi-Table Integration </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="LIB_Features_Comparing_and_validating_tables.html"><div class="navi">+ 9.3.1 Comparing and Validating Tables </div></a></li>
<li class="navi"><a href="LIB_Features_Looking_up_Other_Tables.html"><div class="navi">9.3.2 Looking up Other Tables </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="LIB_Function_table_lookup.html"><div class="navi">9.3.2.1 table lookup ... </div></a></li>
<li class="navi"><a href="LIB_Function_table_lookup_once.html"><div class="navi">9.3.2.2 table lookup once ... </div></a></li>
<li class="navi"><a href="LIB_Function_table_lookup_fast.html"><div class="navi">9.3.2.3 table lookup fast ... </div></a></li>
<li class="navi"><a href="LIB_Function_table_lookup_smart.html"><div class="navi">9.3.2.4 table lookup smart ... </div></a></li>
<li class="navi"><a href="LIB_Function_table_lookup_smart_once.html"><div class="navi">9.3.2.5 table lookup smart once ... </div></a></li>
<li class="navi"><a href="LIB_Function_table_integrate.html"><div class="navi navi-selected">9.3.2.6 table integrate ... </div></a></li>
<li class="navi"><a href="LIB_Function_table_integrate_once.html"><div class="navi">9.3.2.7 table integrate once ... </div></a></li>
<li class="navi"><a href="LIB_Function_table_integrate_fast.html"><div class="navi">9.3.2.8 table integrate fast ... </div></a></li>
<li class="navi"><a href="LIB_Function_table_integrate_smart.html"><div class="navi">9.3.2.9 table integrate smart ... </div></a></li>
<li class="navi"><a href="LIB_Function_table_integrate_smart_once.html"><div class="navi">9.3.2.10 table integrate smart once ... </div></a></li>
<li class="navi"><a href="LIB_Function_table_expand.html"><div class="navi">9.3.2.11 table expand ... </div></a></li>
<li class="navi"><a href="LIB_Function_table_expand_fast.html"><div class="navi">9.3.2.12 table expand fast ... </div></a></li>
<li class="navi"><a href="LIB_Function_table_expand_smart.html"><div class="navi">9.3.2.13 table expand smart ... </div></a></li>
<li class="navi"><a href="LIB_Function_table_expand_fast_smart.html"><div class="navi">9.3.2.14 table expand fast smart ... </div></a></li>
<li class="navi"><a href="LIB_Features_Table_integration_operation_identifiers.html"><div class="navi">9.3.2.15 Table Integration Operation Identifiers </div></a></li>
</ul></li>
<li class="navi"><a href="LIB_Features_Pivoting_and_consolidating_tables.html"><div class="navi">+ 9.3.3 Pivoting and Conosolidating Tables </div></a></li>
<li class="navi"><a href="LIB_Features_Combining_Multiple_Tables.html"><div class="navi">+ 9.3.4 Combining Multiple Tables </div></a></li>
</ul></li>
<li class="navi"><a href="LIB_Features_Formatting_and_Styling_Tables.html"><div class="navi">+ 9.4 Formatting and Styling Tables </div></a></li>
</ul></li>
<li class="navi"><a href="LIB_Features_variables_functions.html"><div class="navi">+ 10 Variables Functions </div></a></li>
<li class="navi"><a href="LIB_Features_directory_and_file_system_functions.html"><div class="navi">+ 11 Directory and File System Functions </div></a></li>
<li class="navi"><a href="LIB_Features_system_functions.html"><div class="navi">+ 12 System Functions </div></a></li>
<li class="navi"><a href="LIB_Features_help_and_support_functions.html"><div class="navi">+ 13 Help and Support Functions </div></a></li>
<li class="navi"><a href="LIB_Features_Cross-functional_info.html"><div class="navi">+ 14 Cross-Functional Info </div></a></li>
<li class="navi"><a href="LIB_Features_Index.html"><div class="navi">15 Index </div></a></li>
</ul>
	</div>

	<div class="article">
<h4> Function Names</h4>
<div class="white_background_color" ><code>table integrate, table integrate ignore case, table integrate top down, table integratetop down ignore case</code></div>
<h4> Description</h4>
<p>
These functions work very similarly like <a class="bold_text" href="LIB_Function_table_lookup.html">table lookup</a>(), with the exception that the data retrieved from the lookup table will not
be copied back to the target table, but an operation is performed with the data already existing in the target table with the retrieved data
and then written back.  Example: You look up data for some numbers and want to add them to the already existing values in the target table.

<br/><br/><img src="Images/Function_table_integrate.jpg" alt="Function 'table integrate'"><br/><br/>

This functions described here provide the option to select rows (8th function parameter) and counting the lookup matches in the lookup table
(9th function parameter).  Using only the first 6th parameters in this function call will behave in the same way as <a class="bold_text" href="LIB_Function_table_lookup.html">table lookup</a>().

</p>
<h4> Call as: <span class="black_text">procedure or function</span></h4>
<h4> Restrictions</h4>
<p>Indirect parameter passing is disabled</p>
<h4> Parameter count</h4>
<p>7 - 9 (For description of 1st-6th parameters and return values: see <a class="bold_text" href="LIB_Function_table_lookup.html">table lookup</a>()</p>
<h4> Parameters</h4>
<table class="simple"><col style = "width:80px"><col style = "width:120px"><col style = "width:800px"><tr><th>No.</th><th>Type</th><th>Description</th></tr>
<tr><td>Opt. 7.<br/>input</td>
<td>parameter set or literal</td>
<td><b>Operation Identifier</b><br/><p>Specify one of the <a class="bold_text" href="LIB_Features_Table_integration_operation_identifiers.html">table integration operation identifiers</a><br>
The number of operation identifiers is less than the number of columns specified in the 3rd (output columns) and 6th parameter (destination columns),
then the default value 'overwrite' is assumed for the remaining columns.  If this parameter contains more elements than columns retrieved, then the exess ones will be ignored.
</p><ul class="bullets"><li class="bullets">Use a literal to specify one value
</li><li class="bullets">Use parameter set to specify multiple values
</li><li class="bullets">Alternatively use a softquoted literal (using single quotation marks) to specify multiple values, separated by commas
</li><li class="bullets">No values can be provided by using empty set {} or blank softquoted literal ''.</li></ul><p></p>
<span class="black_text"><b> Default value: </b></span>{overwrite, ...} (overwrite applies to all parameters)
</td></tr>
<tr><td>Opt. 8.<br/>code</td>
<td>expression<br/>:literal</td>
<td><b>Expression to select rows</b><br/><p>Same as 7th function parameter in <a class="bold_text" href="LIB_Function_table_lookup.html">table lookup</a>().<br>
This function parameter allows you to select the rows in the target table in order to limit the lookups to those rows only.
<br><br>
Specify the conditions or rules to select the row.  See <a class="bold_text" href="LAN_Features_Expressions_to_select_rows.html">expressions to select rows</a>.<br>
<a class="bold_text" href="LAN_Features_partial_table_specification.html">Partial table specification</a> is supported here to reference table columns easily.  Example: <b>[Age]>=21</b>.<br>
<u>Attention</u>: If you are using comparison operators = and <> (instead of == and !=) which allow more than 1 operand on the righ hand side , then make sure you put the entire expression into parentheses.  Otherwise the operators will hijack subsequent function parameters as part of their operands.</p>
<span class="black_text"><b> Default value: </b></span>true (all rows selected)
</td></tr>
<tr><td>Opt. 9.<br/>input</td>
<td>table column</td>
<td><b>Counter column</b><br/><p>Same as 8th function parameter in <a class="bold_text" href="LIB_Function_table_lookup.html">table lookup</a>().<br>
Specify 1 column in the lookup table which shall be used to count the successful lookup made.  This function is useful in order to
get an idea of the data in the lookup table searched frequently, rarely or not at all.  If the column already contains numbers, then
the existing numbers will be incremented, i.e. no reset to zero.
<br><br>

See <a class="bold_text" href="LAN_Features_Table_columns.html">table columns as function parameters</a> for general ruling for this parameter.<br>
Specific rules apply for this function:
</p><ul class="bullets"><li class="bullets">At most one header name or column number must be specified
</li><li class="bullets">If the column is missing in the lookup table, then it will be created.
</li></ul><p>
<u>Hint:</u> If you need this function parameter, but not the 8th function parameter, then write <b>true</b> into the 8th parameter.</p>
<span class="black_text"><b> Default value: </b></span>{} (no column selected)
</td></tr>
</table>
<h4> Return value</h4>
<table class="simple"><col style = "width:120px"><col style = "width:880px"><tr><th>Type</th><th>Description</th></tr>
<tr>
<td>numeral</td>
<td><b>Number of lookups made</b><br/><p>              Every successful lookup (input columns match with search columns are matching) will count 1.</p></td></tr>
</table>
<h4> Examples</h4>
<div class="code_background_color" ><code>&nbsp;&nbsp;table&nbsp;initialize( lookup,<br/>
&nbsp;&nbsp;{&nbsp;&nbsp;{&nbsp;&nbsp;Names,&nbsp;Sports,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scores },<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;Abel,&nbsp;&nbsp;tennis,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;},&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;Bea,&nbsp;&nbsp;&nbsp;squash, 14 },<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;Chuck,&nbsp;racquetball, 13 },&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;Dan,&nbsp;&nbsp;&nbsp;tennis, 8 },<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;Eva,&nbsp;&nbsp;&nbsp;squash,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;},&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;Finn,&nbsp;&nbsp;tennis, 12 },<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;Gini,&nbsp;&nbsp;racquetball,&nbsp;12 },&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;Hugo,&nbsp;&nbsp;squash, 11 } } );<br/>
<br/>
&nbsp;&nbsp;table&nbsp;initialize( target, {{ Sport, Name, Score 1, Score 2, Score 3, Score 4 },<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;racquetball, "", 5, 100, 12&nbsp;&nbsp;},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;squash,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"", 5, 100, 12&nbsp;&nbsp;},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;racquetball, "", 5, 300, 10&nbsp;&nbsp;},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;tennis,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"", 5, 100, 12&nbsp;&nbsp;} } );<br/>
<br/>
&nbsp;&nbsp;//&nbsp;Picks the 1st match and integrates the results<br/>
&nbsp;&nbsp;table&nbsp;integrate( target, Sport,&nbsp;&nbsp;{ Name,&nbsp;&nbsp;Score 1 .. Score 4 },<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lookup,&nbsp;Sports, { Names, 4:Scores }, { overwrite, add, sub, max, average } );<br/>
<br/>
&nbsp;&nbsp;table&nbsp;list ( target );<br/>
</code></div>
<h4> Output</h4>
<div class="output_background_color" ><code>&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;:&nbsp;Sport&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Name&nbsp;&nbsp;|&nbsp;Score&nbsp;1&nbsp;|&nbsp;Score&nbsp;2&nbsp;|&nbsp;Score&nbsp;3&nbsp;|&nbsp;Score&nbsp;4<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;:&nbsp;racquetball&nbsp;|&nbsp;Chuck&nbsp;|&nbsp;18&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;87&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;13&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;6.5&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;:&nbsp;squash&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Bea&nbsp;&nbsp;&nbsp;|&nbsp;19&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;86&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;:&nbsp;racquetball&nbsp;|&nbsp;Chuck&nbsp;|&nbsp;18&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;287&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;13&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;6.5&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;:&nbsp;tennis&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Abel&nbsp;&nbsp;|&nbsp;15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
</code></div><u>Try it yourself:</u> Open <b>LIB_Function_table_integrate.b4p</b> in <a class="bold_text" href="B4P_Examples.zip">B4P_Examples.zip</a>. Decompress before use.
<h4> See also</h4>
<p><a class = "bold_text" href="LIB_Function_table_integrate_once.html">table integrate once</a><br/>
<a class = "bold_text" href="LIB_Function_table_integrate_fast.html">table integrate fast</a><br/>
<a class = "bold_text" href="LIB_Function_table_integrate_smart.html">table integrate smart</a><br/>
<a class = "bold_text" href="LIB_Function_table_integrate_smart_once.html">table integrate smart once</a><br/>
<a class = "bold_text" href="LIB_Function_table_lookup.html">table lookup</a><br/>
<a class = "bold_text" href="LIB_Function_table_expand.html">table expand</a></p>
	</div>
</section>

<div class="footer">
Copyright (C) 2007 - 2020 Georg zur Bonsen, All Rights Reserved
</div>

</div>

</html>	


