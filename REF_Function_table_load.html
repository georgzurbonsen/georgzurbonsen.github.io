<!DOCTYPE html>
<html lang="en-US">	

<head>
<meta charset="utf-8"/>
<title>B4P Reference</title>
<link rel="stylesheet" href="styles.css">
</head>


<div class="wrapper">

<div class="logo">
<a href="index.html">
<img src="Images/B4P_Logo.png" alt="Beyond4P">
</a>
</div>

<div class="header">
<h3>table load ...</h3>
<a accesskey="p" href="REF_Features_Loading_and_saving_tables.html"><span>Prev</span></a> <a accesskey="n" href="REF_Features_Loading_HTML_files.html"><span>Next</span></a> 
</div>

<section>
	<div class="nav">
<div class="booktitle_field">Reference Manual</div>
<ul>
<li class="navi"><a href="GUI_Features_Table_of_Contents.html"><div class="navi"> &#8594; User Guide </div></a></li>
<li class="navi"><a href="REF_Features_Table_of_Contents.html"><div class="navi"> Table of Contents </div></a></li>
<li class="navi"><a href="REF_Features_starting.html"><div class="navi">1 Starting B4P </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="REF_Features_interactive.html"><div class="navi">1.1 Interactive Mode </div></a></li>
<li class="navi"><a href="REF_Features_licensing.html"><div class="navi">1.2 Licensing </div></a></li>
</ul></li>
<li class="navi"><a href="REF_Features_introduction.html"><div class="navi">2 Introduction </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="REF_Features_UNICODE_character_set.html"><div class="navi">2.1 UNICODE Character Set </div></a></li>
<li class="navi"><a href="REF_Features_data_types.html"><div class="navi">2.2 Basic Data Types </div></a></li>
<li class="navi"><a href="REF_Features_variables.html"><div class="navi">2.3 Variables </div></a></li>
<li class="navi"><a href="REF_Features_comments.html"><div class="navi">2.4 Comments </div></a></li>
<li class="navi"><a href="REF_Features_reserved_keywords.html"><div class="navi">2.5 Reserved keywords </div></a></li>
<li class="navi"><a href="REF_Features_path_names.html"><div class="navi">2.6 Path and File Names </div></a></li>
<li class="navi"><a href="REF_Features_Locales.html"><div class="navi">2.7 Locales </div></a></li>
</ul></li>
<li class="navi"><a href="REF_Features_Functions_and_Procedures.html"><div class="navi">3 Functions and Procedures </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="REF_Features_Function_Parameters.html"><div class="navi">3.1 Function Parameters </div></a></li>
<li class="navi"><a href="REF_Features_Function_parameter_directions.html"><div class="navi">3.2 Function Parameter Directions </div></a></li>
<li class="navi"><a href="REF_Features_Function_parameter_types.html"><div class="navi">3.3 Function Parameter Types </div></a></li>
<li class="navi"><a href="REF_Features_Indirect_parameter_passing.html"><div class="navi">3.4 Indirect Parameter Passing </div></a></li>
</ul></li>
<li class="navi"><a href="REF_Features_Function_Library.html"><div class="navi">4 Function Library </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="REF_Features_Control_Flow_Functions.html"><div class="navi">4.1 Control Flow Functions </div></a></li>
<li class="navi"><a href="REF_Features_Type_Conversion_Functions.html"><div class="navi">4.2 Type Conversion and Formatting Functions </div></a></li>
<li class="navi"><a href="REF_Features_Mathematics_and_Statistics.html"><div class="navi">4.3 Mathematics and Statistics </div></a></li>
<li class="navi"><a href="REF_Features_string_functions.html"><div class="navi">4.4 String Functions </div></a></li>
<li class="navi"><a href="REF_Features_date_and_time_functions.html"><div class="navi">4.5 Date and Time Functions </div></a></li>
<li class="navi"><a href="REF_Features_parameter_set_functions.html"><div class="navi">4.6 Parameter Set Functions </div></a></li>
<li class="navi"><a href="REF_Features_table_functions.html"><div class="navi">4.7 Table Functions </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="REF_Features_table_creating_deleting.html"><div class="navi">4.7.1 Creating and Deleting Tables </div></a></li>
<li class="navi"><a href="REF_Features_accessing_table_info.html"><div class="navi">4.7.2 Accessing Table Information </div></a></li>
<li class="navi"><a href="REF_Features_Accessing_table_contents.html"><div class="navi">4.7.3 Accessing Table Contents </div></a></li>
<li class="navi"><a href="REF_Features_Loading_and_saving_tables.html"><div class="navi">4.7.4 Loading and Saving Tables </div></a></li>
<li class="navi"><ul>
<li class="navi"><a href="REF_Function_table_load.html"><div class="navi navi-selected">4.7.4.1 table load ... </div></a></li>
<li class="navi"><a href="REF_Features_Loading_HTML_files.html"><div class="navi">4.7.4.2 Loading HTML files </div></a></li>
<li class="navi"><a href="REF_Features_Loading_XML_files.html"><div class="navi">4.7.4.3 Loading XML files </div></a></li>
<li class="navi"><a href="REF_Features_Loading_JSON_files.html"><div class="navi">4.7.4.4 Loading JSON files </div></a></li>
<li class="navi"><a href="REF_Function_table_save.html"><div class="navi">4.7.4.5 table save ... </div></a></li>
<li class="navi"><a href="REF_Features_Saving_JSON_files.html"><div class="navi">4.7.4.6 Saving JSON files </div></a></li>
</ul></li>
<li class="navi"><a href="REF_Features_Checking_headers.html"><div class="navi">+ 4.7.5 Checking and Processing Headers </div></a></li>
<li class="navi"><a href="REF_Features_Searching_tables.html"><div class="navi">+ 4.7.6 Searching Tables </div></a></li>
<li class="navi"><a href="REF_Features_Processing_table_columns.html"><div class="navi">+ 4.7.7 Processing Table Columns </div></a></li>
<li class="navi"><a href="REF_Features_Processing_table_rows.html"><div class="navi">+ 4.7.8 Processing Table Rows </div></a></li>
<li class="navi"><a href="REF_Features_Processing_table_contents.html"><div class="navi">+ 4.7.9 Processing Table Contents </div></a></li>
<li class="navi"><a href="REF_Features_Copying_and_spitting_tables.html"><div class="navi">+ 4.7.10 Renaming, Copying and Splitting Tables </div></a></li>
<li class="navi"><a href="REF_Features_Checking_and_comparing_tables.html"><div class="navi">+ 4.7.11 Checking and Comparing Tables </div></a></li>
<li class="navi"><a href="REF_Features_Looking_up_Other_Tables.html"><div class="navi">+ 4.7.12 Looking up Other Tables </div></a></li>
<li class="navi"><a href="REF_Features_Pivoting_and_consolidating_tables.html"><div class="navi">+ 4.7.13 Pivoting and Conosolidating Tables </div></a></li>
<li class="navi"><a href="REF_Features_Combining_Multiple_Tables.html"><div class="navi">+ 4.7.14 Combining Multiple Tables </div></a></li>
</ul></li>
<li class="navi"><a href="REF_Features_directory_and_file_system.html"><div class="navi">+ 4.8 Directory and File System Functions </div></a></li>
<li class="navi"><a href="REF_Features_Cross-functional_info.html"><div class="navi">+ 4.9 Cross-Functional Info </div></a></li>
</ul></li>
<li class="navi"><a href="REF_Features_verbose.html"><div class="navi"> Verbose Levels </div></a></li>
</ul>
	</div>

	<div class="article">
<h4> Function Names</h4>
<div class="white_background_color" ><code>table load, table load unchanged</code></div>
<h4> Description</h4>
<p>
This function loads a table from a file.  Following file formats are supported:

</p><table class="bold_column_1" style = "width:1000px"><col style = "width:100px"><col style = "width:200px"><col style = "width:700px">
<tr><td>CSV             </td><td> Comma separated files     </td><td> Files separated with a specified symbol, typically a comma, semicolon or tab</td></tr>
<tr><td>TEXT            </td><td> Text file                 </td><td> Loads text files into a table consisting of 1 column. Every column contains one line of text.</td></tr>
<tr><td>HTML            </td><td> HTML file                 </td><td> Loads a specifically selected table from the HTML file</td></tr>
<tr><td>XML             </td><td> XML (extended markup) file</td><td> Loads a complete XML file into a sequential table</td></tr>
<tr><td>JSON            </td><td> JavaScript Object Notation format </td><td> Loads a complete JSON file into a sequential table</td></tr>
<tr><td>JSON TABLE      </td><td> JavaScript Object Notation format </td><td> Loads a specifically selected JSON table (which is a 2-dimensional array) into a table</td></tr>
</table><p>

For CSV file formats, the function <b>table load</b> will automatically convert numbers with decimal commas (e.g. 123,456) to numbers with decimal points (123.456)
so they can be processed further and conveniently.  This feature is particularly useful with processing data originating from databases or Excel with settings
specific to Germany and some other countries which use decimal commas.  If this automatic conversion is not desired because the table data entries with numbers separated
with a comma but seen as actual numbers but possibly a set of two digits, then use the function <b>table load unchanged</b> instead.   In this case, value like 123,456 remain unchanged.
Various database systems, including SAP, Oracle, Salesforce which support exports as "Excel" files are in fact HTML or MHTML file formats.

<br><br>
A different and dedicated function called <span class="red_text">table load excel file</span>() is available to load contemporary Excel files with the endings .xlsx, and .xlsm.  Prerequisite: File is not encrypted.

<br><br>
<b>Recognizing character formats</b>: B4P tries to automatically identify whether the file is ANSI (ASCII), Win 1252, iso8859-1, and UNICOD: UTF-8, UTF-16 or UTF-16 Big Endian.  The identification
is done by preambles in HTML, byte order marks, usage of non-ANSI characters and typical patterns in UTF-16 formats.

</p>
<h4> Call as: <span class="black_text">procedure or function</span></h4>
<h4> Restrictions</h4>
<p>Indirect parameter passing is disabled<br/>
context for partial table specification is required</p>
<h4> Parameter count</h4>
<p>2-4</p>
<h4> Parameters</h4>
<table class="simple"><col style = "width:80px"><col style = "width:120px"><col style = "width:800px"><tr><th>No.</th><th>Type</th><th>Description</th></tr>
<tr><td>1<br/>input</td>
<td>literal</td>
<td><b>Name of table</b><br/><p>If the table is existing, then it will be initialized first.</p>
</td></tr>
<tr><td>2<br/>input</td>
<td>literal</td>
<td><b>File name</b><br/><p>Specify the file name.  Add the path in front if the file is not located in the current working directory.</p>
</td></tr>
<tr><td>Opt. 3<br/>input</td>
<td>literal</td>
<td><b>File format descriptor</b><br/><p></p><table class="bold_column_1" style = "width:750px"><col style = "width:150px"><col style = "width:600px">
<tr><th>Value       </th><th> Description</th></tr>
<tr><td>,           </td><td> CSV with comma as separator</td></tr>
<tr><td>;           </td><td> CSV with semicolon as separator</td></tr>
<tr><td>?           </td><td> CSV with automatic detection of either comma, semicolon or tab.  The first occurence of these symbols will be used as separators.</td></tr>
<tr><td>CSV         </td><td> Same functionaliy as '?' with automatic dection of separator symbol</td></tr>
<tr><td>1 character </td><td> CSV with any other single character, e.g. "/" as separator</td></tr>
<tr><td>TEXT        </td><td> Text file.  The resulting table contains only one column where the column in every row contains the whole line of text.</td></tr>
<tr><td>HTML        </td><td> Loads HTML file.  See section on <a  href="REF_Features_Loading_HTML_files.html">loading HTML files</a>.</td></tr>
<tr><td>MHTML       </td><td> Loads HTML file.  See section on <a  href="REF_Features_Loading_HTML_files.html">loading HTML files</a>. (Same functionality for time being)</td></tr>
<tr><td>XML         </td><td> Loads XML file.  See section on <a  href="REF_Features_Loading_XML_files.html">loading XML files</a>.</td></tr>
<tr><td>JSON        </td><td> Loads entire JSON file.  See section on <a  href="REF_Features_Loading_JSON_files.html">loading JSON files</a>.</td></tr>
<tr><td>JSON TABLE  </td><td> Loads a specific table (coded as an array) from the JSON file.  See section on <a  href="REF_Features_Loading_JSON_files.html">loading JSON files</a>.</td></tr>
</table><p>
</p>
<span class="black_text"><b> Default value: </b></span>CSV or ?
</td></tr>
<tr><td>Opt. 4<br/>input</td>
<td>parameter set</td>
<td><b>XML attributes to keep</b><br/><p>Applicable to file format descriptor <b>XML</b> only:<br>
Applicable for file format descriptor XML only: Specify the attributes in XML tags to keep.  The remaining ones will not be loaded.
This feature is particularly useful for very large XML files.</p>
<span class="black_text"><b> Default value: </b></span>(Keep all attributes)
</td></tr>
<tr><td>Alt. Opt. 4<br/>input</td>
<td>literal</td>
<td><b>Text pattern</b><br/><p>Applicable to file format descriptors <b>HTML, MJTML, JSON TABLE</b> only:<br>

Specify a text sequence, e.g. JSON elements, HTML elements, etc. which will be checked against the JSON and HTML text.
This feature is insofar useful when the HTML and JSON files contain multiple tables and a table other than the 1st table should be loaded.
In this case, find a unique text, e.g. a section name or distinct contents which appears before the table to load, but after the previous tables in the same file.

<br><br>
<u>Attention:</u> Wildcards are supported for JSON, but not for HTML and MHTML. Example: <b>' "name" : "C*" '</b>  looks for
"name" followed by ":" and followed by "C..." (beginning with "C").

<br><br>
<u>Advice:</u> Put the whole string in single quotation marks beacuse JSON and HTML syntax rules require text contents to be specified in double quotation marks, e.g. <b>'id="NASDAQ_Table"'</b>.

<br><br>
<u>Advice:</u> Some HTML links contain a pound symbol, e.g. "en.wikipedia.org/wiki/List_of_Roman_emperors#The_Principate".  To access the HTML table below this identifier "The_Principate"
which is, typical to Wikipedia, the section header "The Principate", download the entier HTML file and specify <b>'id="The_Principate"'</b> in this parameter to find next table located below.</p>
<span class="black_text"><b> Default value: </b></span>(look for 1st table)
</td></tr>
</table>
<h4> Return value</h4>
<table class="simple"><col style = "width:120px"><col style = "width:880px"><tr><th>Type</th><th>Description</th></tr>
<tr>
<td>boolean</td>
<td><b>Table has contents</b><br/><p>true if contents have been loaded, false if nothing has been loaded. In this case, the table is empty.</p></td></tr>
</table>
<h4> Exceptions</h4>
<p>File not found<br/>
File not accessible<br/>
File locked<br/>
Syntax errors in table formats, e.g in HTML, JSON, XML<br/>
File locked. Close the file in the other application and retry</p>
<h4> Examples</h4>
<div class="code_background_color" ><code> &nbsp;runtime settings[verbose]= quiet; // Supress blabla<br/>
<br/>
 &nbsp;echo("Load the Cities file:");<br/>
 &nbsp;table load( cities, "Examples&#92;Cities.csv" );<br/>
 &nbsp;echo("Cities: ", join( [cities:City,..], ", " ) );<br/>
</code></div>
<h4> Output</h4>
<div class="output_background_color" ><code>Load the Cities file:<br/>
Cities: New York City, Washington, Philadelphia, Boston, San Francisco, Montréal, Copenhagen, Venice, Los Angeles, Vienna, Bangkok, Zürich, Paris, Davos<br/>
</code></div>
<h4> See also</h4>
<p><a href="REF_Function_table_save.html">table save</a><br/>
<span class="red_text">table load excel file</span><br/>
<a href="REF_Features_Loading_XML_files.html">loading XML files</a><br/>
<a href="REF_Features_Loading_JSON_files.html">loading JSON files</a></p>
	</div>
</section>

<div class="footer">
Copyright (C) 2007 - 2020 Georg zur Bonsen
</div>

</div>

</html>	


